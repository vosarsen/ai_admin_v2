// src/services/reminder/templates.js

/**
 * –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∑–∞ –¥–µ–Ω—å (–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–µ —Å –∏–º–µ–Ω–µ–º)
 */
const dayBeforeTemplates = [
  "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä, {name}! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –≤–∞—à–µ–π –∑–∞–ø–∏—Å–∏ –∑–∞–≤—Ç—Ä–∞ –≤ {time} ‚ú®",
  "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {name}! –ó–∞–≤—Ç—Ä–∞ –≤ {time} –∂–¥—ë–º –≤–∞—Å –Ω–∞ {service} üåü",
  "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä, {name}! –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ –∑–∞–≤—Ç—Ä–∞—à–Ω—é—é –∑–∞–ø–∏—Å—å –≤ {time} ‚ò∫Ô∏è",
  "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –ó–∞–≤—Ç—Ä–∞ –≤ {time} –≤–∞—Å –∂–¥—ë—Ç {staff} ‚ú®",
  "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {name}! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º: –∑–∞–≤—Ç—Ä–∞ –≤ {time} —É –≤–∞—Å {service} üìù",
  "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä, {name}! –í—Å—ë –≤ —Å–∏–ª–µ –Ω–∞ –∑–∞–≤—Ç—Ä–∞, {time}? ü§ù",
  "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –≤–∞—à—É –∑–∞–ø–∏—Å—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –≤ {time} ‚úÖ",
  "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {name}! {staff} –∂–¥—ë—Ç –≤–∞—Å –∑–∞–≤—Ç—Ä–∞ –≤ {time} üí´",
  "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä, {name}! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –≤–∏–∑–∏—Ç–µ –∑–∞–≤—Ç—Ä–∞ –≤ {time} üìÖ",
  "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ {time} –Ω–∞ {service} üëã",
  "{name}, –¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä! –ñ–¥—ë–º –≤–∞—Å –∑–∞–≤—Ç—Ä–∞ –≤ {time} ‚ú®",
  "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é –≤–∞—Å, {name}! –ó–∞–≤—Ç—Ä–∞—à–Ω—è—è –∑–∞–ø–∏—Å—å –≤ {time} –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ üåü",
  "{name}, –∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –∑–∞–ø–∏—Å–∏ –∑–∞–≤—Ç—Ä–∞ –≤ {time} üìÖ",
  "–î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä, {name}! {staff} –±—É–¥–µ—Ç —Ä–∞–¥ –≤–∏–¥–µ—Ç—å –≤–∞—Å –∑–∞–≤—Ç—Ä–∞ –≤ {time} üòä",
  "{name}, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –í—Å—ë –≥–æ—Ç–æ–≤–æ –¥–ª—è –≤–∞—à–µ–≥–æ –≤–∏–∑–∏—Ç–∞ –∑–∞–≤—Ç—Ä–∞ –≤ {time} ‚úÖ"
];

/**
 * –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∑–∞ 2 —á–∞—Å–∞ (—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ)
 */
const twoHoursTemplates = [
  "–ù–∞–ø–æ–º–∏–Ω–∞–µ–º: —Å–µ–≥–æ–¥–Ω—è –≤ {time} —É –≤–∞—Å –∑–∞–ø–∏—Å—å –Ω–∞ {service}.",
  "–ß–µ—Ä–µ–∑ 2 —á–∞—Å–∞ –≤–∞—Å –æ–∂–∏–¥–∞–µ—Ç {staff}. –í—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞: {time}.",
  "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –í {time} –º—ã –∂–¥—ë–º –≤–∞—Å –Ω–∞ {service}.",
  "–£–≤–∞–∂–∞–µ–º—ã–π –∫–ª–∏–µ–Ω—Ç, –Ω–∞–ø–æ–º–∏–Ω–∞–µ–º –æ –∑–∞–ø–∏—Å–∏ –≤ {time}.",
  "–ß–µ—Ä–µ–∑ –ø–∞—Ä—É —á–∞—Å–æ–≤ ({time}) –≤–∞—Å –∂–¥—ë—Ç {staff}.",
  "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –≤–∞—à –≤–∏–∑–∏—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –Ω–∞ {time} —Å–µ–≥–æ–¥–Ω—è.",
  "–í {time} –¥–ª—è –≤–∞—Å –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –≤—Ä–µ–º—è. {staff} —É–∂–µ –≥–æ—Ç–æ–≤–∏—Ç—Å—è.",
  "–ñ–¥—ë–º –≤–∞—Å —Å–µ–≥–æ–¥–Ω—è –≤ {time}. –ú–∞—Å—Ç–µ—Ä {staff} –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ.",
  "–í–∞—à–∞ –∑–∞–ø–∏—Å—å –Ω–∞ {service} —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞ ({time}).",
  "–°–∫–æ—Ä–æ –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è! –í–∞—à –≤–∏–∑–∏—Ç –≤ {time}.",
  "–û—Å—Ç–∞–ª–æ—Å—å 2 —á–∞—Å–∞ –¥–æ –≤–∞—à–µ–π –∑–∞–ø–∏—Å–∏ ({time}). {staff} –≤–∞—Å –∂–¥—ë—Ç.",
  "–ù–∞–ø–æ–º–∏–Ω–∞–µ–º –æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –≤–∏–∑–∏—Ç–µ –≤ {time}.",
  "–ß–µ—Ä–µ–∑ 2 —á–∞—Å–∞ ({time}) –Ω–∞—á–Ω—ë—Ç—Å—è –≤–∞—à —Å–µ–∞–Ω—Å. –ú–∞—Å—Ç–µ—Ä: {staff}.",
  "–î–æ –≤—Å—Ç—Ä–µ—á–∏ –≤ {time}! –í—Å—ë –≥–æ—Ç–æ–≤–æ –¥–ª—è –≤–∞—à–µ–≥–æ –≤–∏–∑–∏—Ç–∞.",
  "–í–∞—à–µ –≤—Ä–µ–º—è —Å–µ–≥–æ–¥–Ω—è: {time}. –û—Å—Ç–∞–ª–æ—Å—å 2 —á–∞—Å–∞."
];

/**
 * –û–∫–æ–Ω—á–∞–Ω–∏—è –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∑–∞ –¥–µ–Ω—å
 */
const dayBeforeEndings = [
  "–ï—Å–ª–∏ –ø–ª–∞–Ω—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å - –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å üëç",
  "–ë—É–¥—É—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è - –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º üìù",
  "–ï—Å–ª–∏ –Ω–µ —Å–º–æ–∂–µ—Ç–µ - –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ üôè",
  "–ñ–¥—ë–º –≤–∞—Å! –ï—Å–ª–∏ —á—Ç–æ - –ø–∏—à–∏—Ç–µ üí¨",
  "–î–æ –≤—Å—Ç—Ä–µ—á–∏! –ò–ª–∏ —Å–æ–æ–±—â–∏—Ç–µ, –µ—Å–ª–∏ –ø–ª–∞–Ω—ã –ø–æ–º–µ–Ω—è–ª–∏—Å—å ‚úâÔ∏è",
  "–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ - —Å–æ–æ–±—â–∏—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ üì±",
  "–ñ–¥—ë–º –≤–∞—Å! –ò–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ø–ª–∞–Ω—ã üíå",
  "–î–æ –∑–∞–≤—Ç—Ä–∞! –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–º–µ–Ω—è–ª–æ—Å—å - –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å ü§ù"
];

/**
 * –û–∫–æ–Ω—á–∞–Ω–∏—è –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∑–∞ 2 —á–∞—Å–∞
 */
const twoHoursEndings = [
  "–î–æ –≤—Å—Ç—Ä–µ—á–∏!",
  "–ñ–¥—ë–º –≤–∞—Å!",
  "–î–æ —Å–∫–æ—Ä–æ–π –≤—Å—Ç—Ä–µ—á–∏!",
  "–£–≤–∏–¥–∏–º—Å—è!",
  "–ë—É–¥–µ–º —Ä–∞–¥—ã –≤–∞—Å –≤–∏–¥–µ—Ç—å!",
  "–°–∫–æ—Ä–æ —É–≤–∏–¥–∏–º—Å—è!",
  "–î–æ –≤—Å—Ç—Ä–µ—á–∏ –≤ —Å–∞–ª–æ–Ω–µ!",
  "–ñ–¥—ë–º –≤–∞—Å —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º!"
];

/**
 * –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –º–∞—Å—Å–∏–≤–∞
 */
function getRandomElement(array) {
  return array[Math.floor(Math.random() * array.length)];
}

/**
 * –ó–∞–º–µ–Ω–∏—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —à–∞–±–ª–æ–Ω–µ
 */
function fillTemplate(template, data) {
  let result = template;
  
  // –ó–∞–º–µ–Ω—è–µ–º –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
  result = result.replace('{name}', data.clientName || '–¥–æ—Ä–æ–≥–æ–π –∫–ª–∏–µ–Ω—Ç');
  result = result.replace('{time}', data.time);
  
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫–ª–æ–Ω–µ–Ω–∏—è –¥–ª—è —É—Å–ª—É–≥, –µ—Å–ª–∏ –µ—Å—Ç—å
  if (data.serviceDeclensions) {
    // –î–ª—è —à–∞–±–ª–æ–Ω–æ–≤ —Å "–Ω–∞ {service}" –∏—Å–ø–æ–ª—å–∑—É–µ–º prepositional_na (–ø—Ä–µ–¥–ª–æ–∂–Ω—ã–π —Å –ù–ê)
    if (template.includes('–Ω–∞ {service}')) {
      result = result.replace('–Ω–∞ {service}', 
        `–Ω–∞ ${data.serviceDeclensions.prepositional_na || data.service}`);
    }
    // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ (accusative)
    else {
      result = result.replace('{service}', 
        data.serviceDeclensions.accusative || data.service);
    }
  } else {
    result = result.replace('{service}', data.service);
  }
  
  result = result.replace('{staff}', data.staff);
  
  return result;
}

/**
 * –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å
 */
function generateDayBeforeReminder(data) {
  const template = getRandomElement(dayBeforeTemplates);
  const ending = getRandomElement(dayBeforeEndings);
  
  const mainText = fillTemplate(template, data);
  
  // –°–æ–±–∏—Ä–∞–µ–º –ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  let message = mainText + '\n\n';
  message += `${data.service}\n`;
  message += `–ú–∞—Å—Ç–µ—Ä: ${data.staff}\n`;
  if (data.price > 0) {
    message += `–°—Ç–æ–∏–º–æ—Å—Ç—å: ${data.price} —Ä—É–±.\n`;
  }
  if (data.address) {
    message += `\n–ñ–¥—ë–º –≤–∞—Å –ø–æ –∞–¥—Ä–µ—Å—É: ${data.address}\n`;
  }
  message += '\n' + ending;
  
  return message;
}

/**
 * –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 2 —á–∞—Å–∞
 */
function generateTwoHoursReminder(data) {
  const template = getRandomElement(twoHoursTemplates);
  const ending = getRandomElement(twoHoursEndings);
  
  const mainText = fillTemplate(template, data);
  
  // –°–æ–±–∏—Ä–∞–µ–º –ø–æ–ª–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  let message = mainText + '\n';
  if (data.address) {
    message += `–ê–¥—Ä–µ—Å: ${data.address}\n`;
  }
  message += '\n' + ending;
  
  return message;
}

module.exports = {
  generateDayBeforeReminder,
  generateTwoHoursReminder
};