# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ AI Admin v2

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

## 2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 1: –î–æ–±–∞–≤—å—Ç–µ company_id –≤ staff_schedules
```bash
# –í Supabase SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
# scripts/database/add-company-id-to-staff-schedules-fixed.sql
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã
```bash
# –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è company_id –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
# scripts/database/create-indexes-final.sql
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
# scripts/database/test-index-performance.sql
```

## 3. –ó–∞–ø—É—Å–∫ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä
npm start

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å v2 –≤–æ—Ä–∫–µ—Ä—ã
npm run worker:v2
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
1. –û—Å—Ç–∞–≤—å—Ç–µ —Å—Ç–∞—Ä—ã–µ –≤–æ—Ä–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏–º–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

## 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
npm run monitor
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É–ª—É—á—à–µ–Ω–∏—è
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: –¥–æ–ª–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å—Å—è —Å 800ms –¥–æ 50-300ms
- Cache hit rate: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã—à–µ 70%
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ AI: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∏–∂–µ 2 —Å–µ–∫—É–Ω–¥

## 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã:
```env
# Redis –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your-password-if-set

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
CACHE_TTL_STATIC=1800  # 30 –º–∏–Ω—É—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
CACHE_TTL_DYNAMIC=300  # 5 –º–∏–Ω—É—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
CONTEXT_CACHE_TTL=300  # 5 –º–∏–Ω—É—Ç –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
MAX_SERVICES_LOAD=20   # –ú–∞–∫—Å–∏–º—É–º —É—Å–ª—É–≥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
MAX_STAFF_LOAD=10      # –ú–∞–∫—Å–∏–º—É–º –º–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
```

## 6. –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

### –¢–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å—ã (30% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ì–æ—Ç–æ–≤–æ!

### –ò–Ω–¥–µ–∫—Å—ã + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (50% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
–í —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ AI Admin v2 —É–∂–µ –µ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
```
Context loading: 800-1500ms
Total response: 3-5 seconds
DB queries: 15-20 per request
```

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
```
Context loading: 50-300ms (cache hit: 5-10ms)
Total response: 1-2 seconds
DB queries: 3-5 per request (–ø—Ä–∏ cache miss)
```

## 8. Troubleshooting

### –û—à–∏–±–∫–∞ "company_id does not exist"
- –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é add-company-id-to-staff-schedules-fixed.sql
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–º–µ—é—Ç company_id

### –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–æ–≤
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ ANALYZE –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —á–µ—Ä–µ–∑ EXPLAIN

### Redis connection refused
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Redis –∑–∞–ø—É—â–µ–Ω: `redis-server`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ REDIS_URL –≤ .env

## 9. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é —á–µ—Ä–µ–∑ npm run monitor
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
3. **–ú–∏–≥—Ä–∞—Ü–∏—è —Å Supabase**: –ü—Ä–∏ 1000+ –∫–æ–º–ø–∞–Ω–∏–π —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ self-hosted PostgreSQL

---

**–í–∞–∂–Ω–æ**: –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Ö –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –±–µ–∑ —Ä–∏—Å–∫–∞ —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.