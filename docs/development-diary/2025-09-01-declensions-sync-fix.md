# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–∫–ª–æ–Ω–µ–Ω–∏–π

**–î–∞—Ç–∞**: 1 —Å–µ–Ω—Ç—è–±—Ä—è 2025
**–ê–≤—Ç–æ—Ä**: AI Admin Development Team
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: üî¥ –í—ã—Å–æ–∫–∞—è

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫–ª–æ–Ω–µ–Ω–∏–π (30 –∞–≤–≥—É—Å—Ç–∞ 2025) –∏ –ø–æ–ø—ã—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Ö –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (31 –∞–≤–≥—É—Å—Ç–∞ 2025), –æ–±–Ω–∞—Ä—É–∂–∏–ª–æ—Å—å, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é. –ü—Ä–∏ –Ω–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ 1 —Å–µ–Ω—Ç—è–±—Ä—è —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–Ω–æ–≤–∞ —Å–ª–µ—Ç–µ–ª–∏.

## –°–∏–º–ø—Ç–æ–º—ã

- –í—Å–µ —Å–∫–ª–æ–Ω–µ–Ω–∏—è —É—Å–ª—É–≥ –≤ –ë–î —Å—Ç–∞–ª–∏ NULL –ø–æ—Å–ª–µ –Ω–æ—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –°–∫–ª–æ–Ω–µ–Ω–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞–¥–µ–∂–∞–º–∏

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

–ü—Ä–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ —Ñ–∞–π–ª–æ–≤ `src/sync/services-sync.js` –∏ `src/sync/staff-sync.js` –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥–∏–∫–µ —Ä–∞–±–æ—Ç—ã —Å Map –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∫–ª–æ–Ω–µ–Ω–∏–π.

### –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã

**–í —Ñ–∞–π–ª–µ `services-sync.js`:**

```javascript
// –°—Ç—Ä–æ–∫–∞ 72: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–ª–æ–Ω–µ–Ω–∏–π –∏–∑ –ë–î
existingDeclensionsMap.set(service.yclients_id, service.declensions);

// –°—Ç—Ä–æ–∫–∞ 80: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —É—Å–ª—É–≥
const newServices = services.filter(service => 
  !existingDeclensionsMap.has(service.id)  // ‚ùå –û–®–ò–ë–ö–ê!
);

// –°—Ç—Ä–æ–∫–∞ 97: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–ª–æ–Ω–µ–Ω–∏–π
if (existingDeclensionsMap.has(service.id)) {  // ‚ùå –û–®–ò–ë–ö–ê!
  service.declensions = existingDeclensionsMap.get(service.id);
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** 
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ –ë–î –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –∫–ª—é—á `yclients_id`
- –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –∫–ª—é—á `service.id`
- –•–æ—Ç—è `service.id` –∏–∑ YClients API == `yclients_id` –≤ –ë–î, –Ω–æ —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π
- Map –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è, –≤—Å–µ —É—Å–ª—É–≥–∏ —Å—á–∏—Ç–∞–ª–∏—Å—å "–Ω–æ–≤—ã–º–∏"
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫–ª–æ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å, –≤ –ë–î –∑–∞–ø–∏—Å—ã–≤–∞–ª—Å—è NULL

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ `staff-sync.js`, –Ω–æ —Ç–∞–º –æ–Ω–∞ –Ω–µ –ø—Ä–æ—è–≤–ª—è–ª–∞—Å—å –∏–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Ä–∞–±–æ—Ç—ã —Å –º–∞—Å—Ç–µ—Ä–∞–º–∏.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞:

```javascript
// services-sync.js
// –í–ê–ñ–ù–û: service.id –∏–∑ YClients API —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç yclients_id –≤ –Ω–∞—à–µ–π –ë–î
const existingDeclensionsMap = new Map();
if (existingServices) {
  existingServices.forEach(service => {
    if (service.declensions) {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º yclients_id –∫–∞–∫ –∫–ª—é—á, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å—Å—è —Å service.id –∏–∑ API
      existingDeclensionsMap.set(service.yclients_id, service.declensions);
    }
  });
}
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `staff-sync.js` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è.

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test-sync-fix.js`, –∫–æ—Ç–æ—Ä—ã–π:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–∫–ª–æ–Ω–µ–Ω–∏–π –¥–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫–ª–æ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:**
```
‚úÖ TEST PASSED: All declensions preserved!
Services: { preserved: 5, lost: 0 }
Staff: { preserved: 5, lost: 0 }
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ó–∞–ø—É—â–µ–Ω —Å–∫—Ä–∏–ø—Ç `scripts/fix-declensions-quick.js` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∫–ª–æ–Ω–µ–Ω–∏–π:
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ 45 —Å–∫–ª–æ–Ω–µ–Ω–∏–π —É—Å–ª—É–≥
- –í—Å–µ —Å–∫–ª–æ–Ω–µ–Ω–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ —É–∂–µ –±—ã–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `src/sync/services-sync.js` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –∫–ª—é—á–µ–π
- `src/sync/staff-sync.js` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- `test-sync-fix.js` - —Å–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç (–≤—Ä–µ–º–µ–Ω–Ω—ã–π)

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
1. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω –ø–æ–ª–µ–π** - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã
2. **Map —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –∫–ª—é—á–∞–º** - —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ = –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã** - –ø–æ–º–æ–≥–∞—é—Ç –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –±—É–¥—É—â–µ–º

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞
‚úÖ –°–∫–ª–æ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚úÖ –¢–µ—Å—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è
‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ —Å–∫–ª–æ–Ω–µ–Ω–∏—è

## –£—Ä–æ–∫–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

1. **–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∏–º–µ–Ω–∞–º –ø–æ–ª–µ–π** - –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –º–∞–ø–ø–∏–Ω–≥–µ –º–µ–∂–¥—É API –∏ –ë–î
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** - –Ω—É–∂–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö** - –Ω—É–∂–Ω—ã –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–ª–æ–Ω–µ–Ω–∏–π –≤ –ë–î
SELECT title, declensions->>'accusative' as accusative 
FROM services 
WHERE company_id = 962302 
AND declensions IS NOT NULL 
LIMIT 5;

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
node test-sync-fix.js

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫–ª–æ–Ω–µ–Ω–∏–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
node scripts/fix-declensions-quick.js
```

## –°—Ç–∞—Ç—É—Å

‚úÖ **–†–ï–®–ï–ù–û** - –°–∫–ª–æ–Ω–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏