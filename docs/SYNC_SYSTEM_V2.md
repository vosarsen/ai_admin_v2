# üîÑ –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ YClients ‚Üí Supabase v2.0

> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 12 –∞–≤–≥—É—Å—Ç–∞ 2025  
> **–°—Ç–∞—Ç—É—Å**: ‚úÖ Production Ready  
> **–í–µ—Ä—Å–∏—è**: 2.0 (—Å –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –≤–∏–∑–∏—Ç–æ–≤)

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- [–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ](#—Ä—É—á–Ω–æ–µ-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [Troubleshooting](#troubleshooting)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```bash
node scripts/manual-sync.js status
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
```bash
# –° –≤–∏–∑–∏—Ç–∞–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
SYNC_CLIENT_VISITS=true node scripts/manual-sync.js clients

# –ë–µ–∑ –≤–∏–∑–∏—Ç–æ–≤ (–±—ã—Å—Ç—Ä–æ, —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
node scripts/manual-sync.js clients
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞
```bash
node scripts/check-client-data.js +79001234567
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TD
    YC[YClients API] --> SM[SyncManager]
    SM --> CS[ClientsSync]
    SM --> CRS[ClientRecordsSync]
    SM --> GTS[GoodsTransactionsSync]
    SM --> SS[ServicesSync]
    SM --> STS[StaffSync]
    SM --> SCHS[SchedulesSync]
    
    CS --> DB[(Supabase)]
    CRS --> DB
    GTS --> DB
    SS --> DB
    STS --> DB
    SCHS --> DB
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

| –ú–æ–¥—É–ª—å | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------|------------|
| **SyncManager** | `sync-manager.js` | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π |
| **ClientsSync** | `clients-sync-optimized.js` | –ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| **ClientRecordsSync** | `client-records-sync.js` | –ò—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤ |
| **GoodsTransactionsSync** | `goods-transactions-sync.js` | –¢–æ–≤–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| **ServicesSync** | `services-sync.js` | –ö–∞—Ç–∞–ª–æ–≥ —É—Å–ª—É–≥ |
| **StaffSync** | `staff-sync.js` | –î–∞–Ω–Ω—ã–µ –º–∞—Å—Ç–µ—Ä–æ–≤ |
| **SchedulesSync** | `schedules-sync.js` | –†–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã |

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (Moscow Time)

| –í—Ä–µ–º—è | –ß—Ç–æ | –ó–∞—á–µ–º |
|-------|-----|-------|
| **01:00** | –£—Å–ª—É–≥–∏ | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞ |
| **02:00** | –ú–∞—Å—Ç–µ—Ä–∞ | –ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ |
| **03:00** | üî• **–ö–ª–∏–µ–Ω—Ç—ã + –í–∏–∑–∏—Ç—ã** | –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ |
| **–ö–∞–∂–¥—ã–µ 4—á** | –†–∞—Å–ø–∏—Å–∞–Ω–∏—è | –°–≤–µ–∂–∏–µ —Å–ª–æ—Ç—ã –¥–ª—è –∑–∞–ø–∏—Å–∏ |
| **–ö–∞–∂–¥—ã–µ 15–º** | –ë—É–∫–∏–Ω–≥–∏ | –û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π |
| **00:00 –í–°** | –ö–æ–º–ø–∞–Ω–∏—è | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ |

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ 03:00 (–≥–ª–∞–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—É—é –Ω–æ—á—å
await syncClients({ 
  syncVisitHistory: true,  // ‚úÖ –í–∏–∑–∏—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã
  maxVisitsSync: 10000     // ‚úÖ –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã
});
```

**–≠—Ç–∞–ø—ã:**
1. **–ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** (14 —Å–µ–∫) - –∏–º–µ–Ω–∞, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, total_spent
2. **–ò—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤** (5-10 –º–∏–Ω) - –≤—Å–µ –≤–∏–∑–∏—Ç—ã –∑–∞ 2 –≥–æ–¥–∞
3. **–¢–æ–≤–∞—Ä–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** (30 —Å–µ–∫) - –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤

## üõ†Ô∏è –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```bash
# –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–æ
node scripts/manual-sync.js full

# –¢–æ–ª—å–∫–æ —É—Å–ª—É–≥–∏
node scripts/manual-sync.js services

# –¢–æ–ª—å–∫–æ –º–∞—Å—Ç–µ—Ä–∞
node scripts/manual-sync.js staff

# –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –ë–ï–ó –≤–∏–∑–∏—Ç–æ–≤ (–±—ã—Å—Ç—Ä–æ)
node scripts/manual-sync.js clients

# –ö–ª–∏–µ–Ω—Ç—ã –° –≤–∏–∑–∏—Ç–∞–º–∏ (–ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è)
SYNC_CLIENT_VISITS=true node scripts/manual-sync.js clients

# –¢–æ–ª—å–∫–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
node scripts/manual-sync.js schedules

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
node scripts/manual-sync.js status
```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
node scripts/sync-single-client.js +79001234567

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
node scripts/check-client-data.js +79001234567

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–∞–∑–µ
node scripts/check-sync-status.js

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
node scripts/monitor-sync-progress.js
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
pm2 logs ai-admin-worker-v2 | grep "sync completed"

# –õ–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ SSH
ssh ai-admin-server "pm2 logs ai-admin-worker-v2 --lines 100 | grep sync"
```

### SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```sql
-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT 
  COUNT(*) as total_clients,
  COUNT(CASE WHEN visit_count > 0 THEN 1 END) as with_visits,
  COUNT(CASE WHEN array_length(visit_history, 1) > 0 THEN 1 END) as with_history,
  COUNT(CASE WHEN total_spent > 0 THEN 1 END) as paying_clients,
  MAX(last_sync_at) as last_sync
FROM clients;

-- –¢–æ–ø –∫–ª–∏–µ–Ω—Ç—ã
SELECT 
  name, 
  phone, 
  visit_count, 
  total_spent,
  services_amount,
  goods_amount,
  loyalty_level,
  last_visit_date
FROM clients
WHERE visit_count > 0
ORDER BY total_spent DESC
LIMIT 10;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
SELECT 
  name,
  visit_history,
  last_services
FROM clients
WHERE phone = '79001234567';
```

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
1. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ SyncManager?
   ```bash
   pm2 status
   pm2 logs ai-admin-worker-v2
   ```

2. –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏?
   ```bash
   pm2 logs ai-admin-worker-v2 --err
   ```

3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏ —Ç–æ–∫–µ–Ω—ã YClients?
   ```bash
   grep "YclientsClient initialized" ~/.pm2/logs/ai-admin-worker-v2-out.log
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –í–∏–∑–∏—Ç—ã –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
grep SYNC_CLIENT_VISITS .env

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å
SYNC_CLIENT_VISITS=true

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é —Å –≤–∏–∑–∏—Ç–∞–º–∏
SYNC_CLIENT_VISITS=true node scripts/manual-sync.js clients
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î–æ–ª–≥–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
1. –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤–∏–∑–∏—Ç–æ–≤
2. –ó–∞–ø—É—Å–∫–∞—Ç—å –≤ –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è (–º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏

**–≠—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!** –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏:
- `visit_history` –∏ `last_services` –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø—É—Å—Ç—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏
- –ü—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤–∏–∑–∏—Ç–æ–≤ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- `total_spent` –±–µ—Ä–µ—Ç—Å—è –∏–∑ YClients –∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –û–±—ä–µ–º |
|----------|-------|-------|
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ | 14 —Å–µ–∫ | 1,097 –∑–∞–ø–∏—Å–µ–π |
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–∏–∑–∏—Ç–æ–≤ | 10-15 –º–∏–Ω | ~400 –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É—Å–ª—É–≥ | 2 —Å–µ–∫ | 45 –∑–∞–ø–∏—Å–µ–π |
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ | 1 —Å–µ–∫ | 3 –∑–∞–ø–∏—Å–∏ |
| –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π | 5 —Å–µ–∫ | 30 –¥–Ω–µ–π |

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` —Ñ–∞–π–ª–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Bearer + User —Ç–æ–∫–µ–Ω—ã –¥–ª—è YClients
- Partner ID –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤
- –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ v2.0

1. **–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥—É—é –Ω–æ—á—å
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤** - services_amount –∏ goods_amount
3. **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä–∏** - –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—Ç–∏—Ä–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –±–∞—Ç—á–∏–Ω–≥ –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```bash
# YClients API
YCLIENTS_BEARER_TOKEN=your_bearer_token
YCLIENTS_USER_TOKEN=your_user_token  
YCLIENTS_PARTNER_ID=8444

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
SYNC_CLIENT_VISITS=true  # –í–∫–ª—é—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤–∏–∑–∏—Ç–æ–≤
SYNC_BATCH_SIZE=50       # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
SYNC_MAX_CLIENTS=10000   # –ú–∞–∫—Å–∏–º—É–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –≤–∏–∑–∏—Ç–æ–≤

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_key
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–§–∞–π–ª: `src/sync/sync-manager.js`

```javascript
this.schedule = {
  services: '0 1 * * *',     // 01:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
  staff: '0 2 * * *',        // 02:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
  clients: '0 3 * * *',      // 03:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
  schedules: '0 */4 * * *',  // –ö–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
  bookings: '*/15 * * * *',  // –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
  company: '0 0 * * 0',      // 00:00 –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
  visits: '0 4 * * *'        // 04:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ (–µ—Å–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ)
};
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

- [ ] PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—â–µ–Ω—ã (`pm2 status`)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24—á
- [ ] –ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è < 24—á –Ω–∞–∑–∞–¥
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –≤–∏–∑–∏—Ç–∞–º–∏ > 300
- [ ] total_spent —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç YClients
- [ ] visit_history –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –≤–∏–∑–∏—Ç–∞–º–∏

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `pm2 logs ai-admin-worker-v2`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `node scripts/check-sync-status.js`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `docs/TROUBLESHOOTING.md`
4. –°–æ–∑–¥–∞—Ç—å issue –≤ GitHub —Å –ª–æ–≥–∞–º–∏