# üîê YClients Marketplace Authorization Flow

## ‚ö° –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ YClients –ù–ï —Ç—Ä–µ–±—É—é—Ç User Token!**

–ö–æ–≥–¥–∞ —Å–∞–ª–æ–Ω –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å YClients:
- ‚úÖ YClients –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ Partner Token + salon_id = –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ API —Å–∞–ª–æ–Ω–∞
- ‚úÖ –ù–ï –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å —É –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –ù–ï –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å User Token —á–µ—Ä–µ–∑ /auth

## üéØ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Flow –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 1Ô∏è‚É£ –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç "–ü–æ–¥–∫–ª—é—á–∏—Ç—å" –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ

YClients –¥–µ–ª–∞–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –Ω–∞—à —Å–∞–π—Ç:
```
https://ai-admin.app/marketplace/register?salon_id=962302
```

### 2Ô∏è‚É£ –ú—ã –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å–∞–ª–æ–Ω–∞

```javascript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º –¢–û–õ–¨–ö–û Partner Token!
const response = await fetch(`https://api.yclients.com/api/v1/company/${salon_id}`, {
  headers: {
    'Authorization': `Bearer ${PARTNER_TOKEN}`,
    'Accept': 'application/vnd.yclients.v2+json'
  }
});

// –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∞–ª–æ–Ω–µ
const company = await response.json();
```

### 3Ô∏è‚É£ –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WhatsApp –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º callback

```javascript
// –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ callback
await fetch('https://api.yclients.com/marketplace/partner/callback/redirect', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${PARTNER_TOKEN}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    salon_id: 962302,
    application_id: OUR_APP_ID,  // ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ
    api_key: generateApiKey(),    // –ù–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–ª—é—á –¥–ª—è —Å–∞–ª–æ–Ω–∞
    webhook_urls: [
      'https://ai-admin.app/webhook/yclients/962302'
    ]
  })
});
```

### 4Ô∏è‚É£ –ü–æ—Å–ª–µ callback –∏–º–µ–µ–º –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø

```javascript
// –¢–µ–ø–µ—Ä—å –º–æ–∂–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ –≤—Å–µ–º–∏ API endpoints —Å–∞–ª–æ–Ω–∞
const headers = {
  'Authorization': `Bearer ${PARTNER_TOKEN}`,
  'Accept': 'application/vnd.yclients.v2+json'
};

// ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
GET https://api.yclients.com/api/v1/clients/${salon_id}

// ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏
POST https://api.yclients.com/api/v1/records/${salon_id}

// ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
GET https://api.yclients.com/api/v1/schedule/${salon_id}

// ‚úÖ –ü–æ–ª—É—á–∞—Ç—å —É—Å–ª—É–≥–∏ –∏ –º–∞—Å—Ç–µ—Ä–æ–≤
GET https://api.yclients.com/api/v1/services/${salon_id}
GET https://api.yclients.com/api/v1/staff/${salon_id}
```

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç–æ–¥ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è | –î–æ—Å—Ç—É–ø |
|-------|-------------------|---------------|---------|
| **Marketplace Flow** | –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ | Partner Token + salon_id | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∞–ª–æ–Ω—É |
| **Direct API** | –ü—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | Partner Token + User Token | –û–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–∞–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **Public API** | –í–∏–¥–∂–µ—Ç—ã –∑–∞–ø–∏—Å–∏ | –¢–æ–ª—å–∫–æ Partner Token | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### ‚úÖ –ß—Ç–æ –ú–û–ñ–ù–û –¥–µ–ª–∞—Ç—å —Å Partner Token –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å:
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∑–∞–ø–∏—Å—è–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ —Å–∞–ª–æ–Ω–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å–ª—É–≥–∞—Ö –∏ —Ü–µ–Ω–∞—Ö
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞–º–∏
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞–º

### ‚ùå –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å:
- –ó–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å —É –∫–ª–∏–µ–Ω—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ /auth –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è User Token
- –•—Ä–∞–Ω–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ë–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª–µ–π (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ—Å—Ç—É–ø)

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```mermaid
graph TD
    A[–ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç –ü–æ–¥–∫–ª—é—á–∏—Ç—å] --> B[YClients –¥–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ]
    B --> C[–†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ ai-admin.app]
    C --> D[–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ WhatsApp]
    D --> E[Callback –≤ YClients]
    E --> F[–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞]
    F --> G[–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ API]

    H[–ö–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ] --> I[YClients –æ—Ç–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø]
    I --> J[Webhook: uninstall]
    J --> K[–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö]
```

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Marketplace –ø–æ–¥—Ö–æ–¥–∞

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞** - –æ–¥–∏–Ω –∫–ª–∏–∫ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ —Ö—Ä–∞–Ω–∏–º –ø–∞—Ä–æ–ª–∏
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –¥–æ—Å—Ç—É–ø –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - YClients —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∞–º–∏
5. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ–º –∫–∞–∫ Beauty Bot –∏ –¥—Ä—É–≥–∏–µ —Ç–æ–ø–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] –ü–æ–Ω—è—Ç—å, —á—Ç–æ User Token –Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint `/marketplace/register`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É callback –≤ YClients
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook endpoints
- [ ] –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–ø—Ä–æ—Å–µ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [MARKETPLACE_INTEGRATION.md](./MARKETPLACE_INTEGRATION.md) - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [MARKETPLACE_CLIENT_FLOW.md](../business/MARKETPLACE_CLIENT_FLOW.md) - –î–µ—Ç–∞–ª—å–Ω—ã–π flow –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [YCLIENTS_API.md](../../YCLIENTS_API.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è YClients API

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 02.10.2025
**–ê–≤—Ç–æ—Ä**: AI Admin Team
**–í–µ—Ä—Å–∏—è**: 1.0