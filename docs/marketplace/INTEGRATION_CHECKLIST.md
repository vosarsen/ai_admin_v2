# üìã –ß–µ–∫-–ª–∏—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å YClients Marketplace

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. Registration Redirect URL ‚úÖ
- Endpoint: `https://ai-admin.app/auth/yclients/redirect`
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç GET –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `salon_id`, `user_id`, `user_name`, `user_phone`, `user_email`
- –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–º–ø–∞–Ω–∏—é –≤ –ë–î
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

### 2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ ‚úÖ
- URL: `https://ai-admin.app/marketplace/onboarding`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç QR-–∫–æ–¥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WhatsApp
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 3. Callback URL ‚úÖ
- Endpoint: `https://ai-admin.app/callback/yclients`
- –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å webhook —Å–æ–±—ã—Ç–∏—è:
  - `uninstall` - —É–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - `freeze` - –∑–∞–º–æ—Ä–æ–∑–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - `payment` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–ª–∞—Ç–µ
  - `record_created/updated/deleted` - —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å–µ–π

### 4. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚úÖ
- Endpoint: `https://ai-admin.app/marketplace/activate`
- –ö–æ–Ω—Ç—Ä–æ–ª—å 1-—á–∞—Å–æ–≤–æ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WhatsApp

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- –¢–∞–±–ª–∏—Ü—ã `companies`, `marketplace_events`, `marketplace_tokens` —Å–æ–∑–¥–∞–Ω—ã

### 6. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ
- HTTPS/SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- Nginx —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WebSocket
- Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- Session Pool –¥–ª—è Baileys –æ–±–Ω–æ–≤–ª–µ–Ω

### 7. Health-check ‚úÖ
- Endpoint: `https://ai-admin.app/marketplace/health-check`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å —É YClients

### 1. Partner Token üî¥
**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ–º –æ—Ç YClients –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
**–î–µ–π—Å—Ç–≤–∏–µ:** –ó–∞–º–µ–Ω–∏—Ç—å `test_token_waiting_for_real` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ `.env`

### 2. API endpoint –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ üî¥
**–¢–µ–∫—É—â–∏–π (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π):** `https://api.yclients.com/api/v1/marketplace/activate`
**–ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å:**
- –¢–æ—á–Ω—ã–π URL endpoint
- –ú–µ—Ç–æ–¥ (POST?)
- –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

### 3. User ID —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è üî¥
**–û–ø–∏—Å–∞–Ω–∏–µ:** ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ –õ–ö –∫–ª–∏–µ–Ω—Ç–∞
**–ì–¥–µ —É–∫–∞–∑–∞—Ç—å:** –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ
**–ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å:** –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 4. –§–æ—Ä–º–∞—Ç webhook –ø–æ–¥–ø–∏—Å–∏ üü°
**–í–æ–ø—Ä–æ—Å:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ YClients –ø–æ–¥–ø–∏—Å—å webhook –∑–∞–ø—Ä–æ—Å–æ–≤?
**–ï—Å–ª–∏ –¥–∞:** –ö–∞–∫–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏ –≥–¥–µ –≤–∑—è—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á?

### 5. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ API üü°
**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø—Ä–∞–≤–∞ –±—É–¥—É—Ç —É –Ω–∞—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏?
**–ù—É–∂–Ω–æ:** –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö endpoints –∏ –æ–ø–µ—Ä–∞—Ü–∏–π

## üìù –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏ YClients

1. **–ö–∞–∫–æ–π —Ç–æ—á–Ω—ã–π API endpoint –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?**
   - URL
   - –ú–µ—Ç–æ–¥ (POST/PUT?)
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏
   - –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
   - –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

2. **–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Partner Token?**
   - –í –∫–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –æ–Ω –Ω—É–∂–µ–Ω?
   - –§–æ—Ä–º–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏?

3. **–ß—Ç–æ —Ç–∞–∫–æ–µ User ID —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≥–¥–µ –µ–≥–æ –≤–∑—è—Ç—å?**

4. **–ï—Å—Ç—å –ª–∏ webhook signature –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤?**

5. **–ö–∞–∫–∏–µ API endpoints –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏?**

## üöÄ –î–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

1. –û–±–Ω–æ–≤–∏—Ç—å `.env` —Å —Ä–µ–∞–ª—å–Ω—ã–º Partner Token:
```bash
ssh -i ~/.ssh/id_ed25519_ai_admin root@46.149.70.219
cd /opt/ai-admin
nano .env
# –ó–∞–º–µ–Ω–∏—Ç—å YCLIENTS_PARTNER_TOKEN=test_token_waiting_for_real
pm2 restart ai-admin-api
```

2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å endpoint –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ `src/api/routes/yclients-marketplace.js`

3. –î–æ–±–∞–≤–∏—Ç—å User ID —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π flow —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–∞–ª–æ–Ω–æ–º

## üìä –¢–µ–∫—É—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 85%

### –ë–ª–æ–∫–µ—Ä—ã:
- Partner Token –æ—Ç YClients
- –¢–æ—á–Ω—ã–π API endpoint –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- User ID —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤!

---
*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 03.10.2025*