# Как получить Service Role ключ из Supabase

## Почему это важно?
Service role ключ обходит Row Level Security (RLS) и дает полный доступ к базе данных. Это необходимо для backend приложений.

## Где найти Service Role ключ:

1. **Откройте Supabase Dashboard**
   - Перейдите на https://app.supabase.com
   - Выберите ваш проект

2. **Перейдите в Settings → API**
   - В левом меню выберите Settings (иконка шестеренки)
   - Затем выберите API

3. **Найдите раздел "Project API keys"**
   - Там будет два ключа:
     - `anon public` - для публичного доступа (ограничен RLS)
     - `service_role secret` - для backend (обходит RLS)

4. **Скопируйте service_role ключ**
   - Нажмите на иконку копирования рядом с service_role
   - ⚠️ **ВАЖНО**: Этот ключ дает полный доступ к БД, храните его в безопасности!

## Как обновить в приложении:

1. **На сервере отредактируйте .env файл:**
```bash
ssh -i ~/.ssh/id_ed25519_ai_admin root@46.149.70.219
cd /opt/ai-admin
nano .env
```

2. **Замените SUPABASE_KEY:**
```env
# Было (anon key):
SUPABASE_KEY=eyJhbGc...старый_anon_ключ...

# Стало (service_role key):
SUPABASE_KEY=eyJhbGc...новый_service_role_ключ...
```

3. **Перезапустите приложение:**
```bash
pm2 restart all
```

## Преимущества использования service_role:

1. **Полный доступ** - нет ограничений RLS
2. **Упрощение политик** - политики нужны только для service_role
3. **Безопасность** - anon ключ не сможет получить доступ к данным
4. **Производительность** - нет проверок RLS при каждом запросе

## Безопасность:

- ❌ **НИКОГДА** не используйте service_role ключ в frontend приложениях
- ❌ **НИКОГДА** не коммитьте его в Git
- ✅ Храните только в .env файлах на сервере
- ✅ Используйте только для backend операций