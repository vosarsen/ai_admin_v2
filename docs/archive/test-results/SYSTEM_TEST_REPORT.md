# –û—Ç—á–µ—Ç –æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã AI Admin v2

## –î–∞—Ç–∞: 26 –∞–≤–≥—É—Å—Ç–∞ 2025
## –í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã: 2.0.0

## üìä –ò—Ç–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –†–µ–∑—É–ª—å—Ç–∞—Ç—ã |
|-----------|--------|------------|
| **Redis –ë–∞—Ç—á–∏–Ω–≥** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–æ–æ–±—â–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è |
| **Context System v2** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ |
| **API Webhook** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è |
| **Batch Processor** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–∞—Ç—á–∏ –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞ |
| **Message Queue** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–µ—Ä–µ–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–∞–º |
| **Worker v2** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å –ø–æ–º–æ—â—å—é AI |
| **WhatsApp Client** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞–º |

## üß™ –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç 1: –ë–∞—Ç—á–∏–Ω–≥ –±—ã—Å—Ç—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
**–°—Ü–µ–Ω–∞—Ä–∏–π**: –û—Ç–ø—Ä–∞–≤–∫–∞ 3 —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º < 1 —Å–µ–∫
```
‚Üí "–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è"
‚Üí "–Ω–∞ —Å—Ç—Ä–∏–∂–∫—É –º–∞—à–∏–Ω–∫–æ–π"  
‚Üí "–∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –≤ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
```
"–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É –º–∞—à–∏–Ω–∫–æ–π –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
```

### –¢–µ—Å—Ç 2: –¢–∞–π–º–∞—É—Ç –±–∞—Ç—á–∏–Ω–≥–∞
**–°—Ü–µ–Ω–∞—Ä–∏–π**: –û–∂–∏–¥–∞–Ω–∏–µ 9 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ë–∞—Ç—á –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞
- –ó–∞–¥–µ—Ä–∂–∫–∞: 9455ms (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ: 9000ms)
- –¢–æ—á–Ω–æ—Å—Ç—å: 99.4%

### –¢–µ—Å—Ç 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞
**–°—Ü–µ–Ω–∞—Ä–∏–π**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –ö–ª—é—á–∏ –¥–∏–∞–ª–æ–≥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è: `dialog:962302:79001234567`
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π: `messages:962302:+79001234567`
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è: `preferences:962302:+79001234567`

### –¢–µ—Å—Ç 4: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö –±–∞—Ç—á–µ–π
**–°—Ü–µ–Ω–∞—Ä–∏–π**: –û—Ç–ø—Ä–∞–≤–∫–∞ 8 –±—ã—Å—Ç—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–∏–Ω –±–∞—Ç—á

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- **–ü—Ä–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è API**: ~10-15ms
- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –±–∞—Ç—á**: ~5ms
- **–û–∂–∏–¥–∞–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–∞**: 9000ms (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞—Ç—á–∞**: ~12ms
- **–ü–µ—Ä–µ–¥–∞—á–∞ –≤ –æ—á–µ—Ä–µ–¥—å**: ~5ms
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ AI**: 5-15 —Å–µ–∫—É–Ω–¥
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞**: 1-2 —Å–µ–∫—É–Ω–¥—ã

### –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:
- **API**: –¥–æ 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **Batch Processor**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- **Worker v2**: 3-5 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ (—Å AI)

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

### Redis –±–∞—Ç—á–∏–Ω–≥:
```javascript
{
  defaultTTL: 600,      // 10 –º–∏–Ω—É—Ç
  batchTimeout: 9000,   // 9 —Å–µ–∫—É–Ω–¥
  maxBatchSize: 10      // –º–∞–∫—Å–∏–º—É–º —Å–æ–æ–±—â–µ–Ω–∏–π
}
```

### –ü—Ä–æ—Ü–µ—Å—Å—ã PM2:
| –ü—Ä–æ—Ü–µ—Å—Å | –≠–∫–∑–µ–º–ø–ª—è—Ä—ã | –ü–∞–º—è—Ç—å | CPU |
|---------|------------|--------|-----|
| ai-admin-api | 1 | 88MB | 0% |
| ai-admin-batch-processor | 1 | 61MB | 0% |
| ai-admin-worker-v2 | 1 | 62MB | 0% |
| venom-bot | 1 | 94MB | 0% |

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ:
1. ‚úÖ **REDIS_URL –≤ .env** - –∏–∑–º–µ–Ω–µ–Ω —Å 6380 –Ω–∞ 6379
2. ‚úÖ **Circuit breaker API** - –æ–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ getBreaker ‚Üí get
3. ‚úÖ **Context service** - –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ v2 –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### –¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
1. ‚ö†Ô∏è **Rate limiting** - –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2. ‚ö†Ô∏è **Venom Bot —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã Puppeteer

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –£–≤–µ–ª–∏—á–∏—Ç—å –≤–æ—Ä–∫–µ—Ä—ã –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏
3. **–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä –ª–æ–≥–æ–≤

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å E2E —Ç–µ—Å—Ç—ã
2. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –û–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
3. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ AI Admin v2 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ **–ë–∞—Ç—á–∏–Ω–≥** –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –±—ã—Å—Ç—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –¥–∏–∞–ª–æ–≥–∞–º–∏  
- ‚úÖ **AI –æ–±—Ä–∞–±–æ—Ç–∫–∞** –¥–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- ‚úÖ **WhatsApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

### –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
1. –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å Redis —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
2. –ë–∞—Ç—á–∏–Ω–≥ –¥–µ–ª–∞–µ—Ç –±–æ—Ç–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º
3. Context v2 —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
4. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status

# –õ–æ–≥–∏ batch processor
pm2 logs ai-admin-batch-processor --lines 100

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Redis
redis-cli -a $REDIS_PASSWORD monitor

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞—Ç—á–µ–π
curl http://46.149.70.219:3000/webhook/whatsapp/batched/stats
```

---

*–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ: 26.08.2025*
*–°–ª–µ–¥—É—é—â–µ–µ –ø–ª–∞–Ω–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: —á–µ—Ä–µ–∑ 1 –º–µ—Å—è—Ü*