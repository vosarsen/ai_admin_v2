# üîê –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ YClients Marketplace

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —É–≥—Ä–æ–∑ –∏ –∑–∞—â–∏—Ç—ã](#–æ–±–∑–æ—Ä-—É–≥—Ä–æ–∑-–∏-–∑–∞—â–∏—Ç—ã)
2. [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
3. [–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–∏-—Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
4. [–ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫](#–∑–∞—â–∏—Ç–∞-–æ—Ç-–∞—Ç–∞–∫)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
6. [–ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—á–µ–∫–ª–∏—Å—Ç-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
7. [–ò–Ω—Ü–∏–¥–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç](#–∏–Ω—Ü–∏–¥–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç)

## üéØ –û–±–∑–æ—Ä —É–≥—Ä–æ–∑ –∏ –∑–∞—â–∏—Ç—ã

### –ú–∞—Ç—Ä–∏—Ü–∞ —É–≥—Ä–æ–∑

| –£–≥—Ä–æ–∑–∞ | –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ | –°—Ç–∞—Ç—É—Å –∑–∞—â–∏—Ç—ã | –ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã |
|--------|---------------|---------------|-------------|
| SQL Injection | –í—ã—Å–æ–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è ID |
| XSS | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| CSRF | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | JWT —Ç–æ–∫–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ origin |
| DDoS | –í—ã—Å–æ–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Rate limiting, IP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ |
| –£—Ç–µ—á–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ | –í—ã—Å–æ–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Headers –≤–º–µ—Å—Ç–æ query, HTTPS |
| –ë—Ä—É—Ç—Ñ–æ—Ä—Å | –°—Ä–µ–¥–Ω–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Rate limiting, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| MITM | –í—ã—Å–æ–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ | –ù–∏–∑–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### JWT Configuration

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞

```bash
# –ú–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞
openssl rand -base64 32
# –†–µ–∑—É–ª—å—Ç–∞—Ç: gKvF3HsP9mXr2LQwZ8Nt4Yx7Dc5Jb1Rf6Ua0Eo3Ip+w=

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ JWT

```javascript
// –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è JWT
const jwt = require('jsonwebtoken');

const JWT_CONFIG = {
  secret: process.env.JWT_SECRET,
  expiresIn: '24h', // –¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 24 —á–∞—Å–∞
  algorithm: 'HS256',
  issuer: 'ai-admin.app',
  audience: 'yclients-marketplace'
};

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
function createToken(payload) {
  if (!process.env.JWT_SECRET) {
    throw new Error('JWT_SECRET –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
  }

  return jwt.sign(payload, JWT_CONFIG.secret, {
    expiresIn: JWT_CONFIG.expiresIn,
    algorithm: JWT_CONFIG.algorithm,
    issuer: JWT_CONFIG.issuer,
    audience: JWT_CONFIG.audience
  });
}

// –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
function verifyToken(token) {
  try {
    return jwt.verify(token, JWT_CONFIG.secret, {
      algorithms: [JWT_CONFIG.algorithm],
      issuer: JWT_CONFIG.issuer,
      audience: JWT_CONFIG.audience
    });
  } catch (error) {
    logger.error('JWT verification failed:', error);
    throw new Error('Invalid token');
  }
}
```

### API Key Management

```javascript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª—é—á–∞
function generateAPIKey() {
  const prefix = 'sk_'; // Secret key prefix
  const randomBytes = crypto.randomBytes(32).toString('hex');
  return `${prefix}${randomBytes}`;
}

// –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
async function hashAPIKey(apiKey) {
  const salt = await bcrypt.genSalt(10);
  return bcrypt.hash(apiKey, salt);
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞
async function validateAPIKey(apiKey, hashedKey) {
  return bcrypt.compare(apiKey, hashedKey);
}
```

## üõ°Ô∏è –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –§—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```javascript
// src/utils/validators.js

/**
 * –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 */
class SecurityValidator {

  // –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection
  static validateId(id) {
    const numId = parseInt(id);

    if (!Number.isInteger(numId) || numId <= 0) {
      throw new Error('Invalid ID format');
    }

    // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ INT –≤ PostgreSQL
    if (numId > 2147483647) {
      throw new Error('ID exceeds maximum value');
    }

    return numId;
  }

  // –ó–∞—â–∏—Ç–∞ –æ—Ç XSS
  static sanitizeString(input, maxLength = 255) {
    if (!input) return '';

    return input
      .replace(/[<>]/g, '') // –£–¥–∞–ª—è–µ–º —Ç–µ–≥–∏
      .replace(/javascript:/gi, '') // –£–¥–∞–ª—è–µ–º JS
      .replace(/on\w+=/gi, '') // –£–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      .trim()
      .substring(0, maxLength);
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è email –ø—Ä–æ—Ç–∏–≤ injection
  static validateEmail(email) {
    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

    if (!emailRegex.test(email)) {
      throw new Error('Invalid email format');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
    if (email.includes('--') || email.includes('/*') || email.includes('*/')) {
      throw new Error('Suspicious email content');
    }

    return email.toLowerCase();
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  static validatePhone(phone) {
    const cleanPhone = phone.replace(/\D/g, '');

    if (cleanPhone.length < 10 || cleanPhone.length > 15) {
      throw new Error('Invalid phone length');
    }

    return cleanPhone;
  }

  // –ó–∞—â–∏—Ç–∞ –æ—Ç Path Traversal
  static sanitizePath(path) {
    return path
      .replace(/\.\./g, '')
      .replace(/\/\//g, '/')
      .replace(/\\/g, '');
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è JSON
  static validateJSON(jsonString) {
    try {
      const parsed = JSON.parse(jsonString);

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≥–ª—É–±–∏–Ω—É –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
      if (this.getDepth(parsed) > 10) {
        throw new Error('JSON too deeply nested');
      }

      return parsed;
    } catch (error) {
      throw new Error('Invalid JSON');
    }
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª—É–±–∏–Ω—ã –æ–±—ä–µ–∫—Ç–∞
  static getDepth(obj) {
    if (obj == null) return 0;

    if (typeof obj !== 'object') return 0;

    return 1 + Math.max(0, ...Object.values(obj).map(v => this.getDepth(v)));
  }
}
```

## üö® –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

### Rate Limiting Implementation

```javascript
// src/middleware/advanced-rate-limiter.js

class AdvancedRateLimiter {
  constructor() {
    this.limits = new Map();
    this.blacklist = new Set();

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    this.config = {
      windowMs: 60 * 1000, // 1 –º–∏–Ω—É—Ç–∞
      maxRequests: 30, // –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤
      blockDuration: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
      suspiciousThreshold: 100 // –ü–æ—Ä–æ–≥ –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    };
  }

  check(ip) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
    if (this.blacklist.has(ip)) {
      return { allowed: false, reason: 'Blacklisted' };
    }

    const now = Date.now();
    const record = this.limits.get(ip) || { count: 0, resetTime: now + this.config.windowMs };

    // –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –µ—Å–ª–∏ –æ–∫–Ω–æ –∏—Å—Ç–µ–∫–ª–æ
    if (now > record.resetTime) {
      record.count = 0;
      record.resetTime = now + this.config.windowMs;
    }

    record.count++;

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    if (record.count > this.config.suspiciousThreshold) {
      this.blacklist.add(ip);
      logger.warn(`IP ${ip} –¥–æ–±–∞–≤–ª–µ–Ω –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å`);
      return { allowed: false, reason: 'Suspicious activity detected' };
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞
    if (record.count > this.config.maxRequests) {
      return {
        allowed: false,
        reason: 'Rate limit exceeded',
        retryAfter: record.resetTime - now
      };
    }

    this.limits.set(ip, record);
    return { allowed: true, remaining: this.config.maxRequests - record.count };
  }

  // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
  cleanup() {
    const now = Date.now();

    for (const [ip, record] of this.limits.entries()) {
      if (now > record.resetTime + this.config.blockDuration) {
        this.limits.delete(ip);
      }
    }
  }
}
```

### DDoS Protection

```nginx
# Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
limit_conn_zone $binary_remote_addr zone=conn_limit:10m;
limit_conn conn_limit 10;

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
limit_req_zone $binary_remote_addr zone=req_limit:10m rate=30r/m;
limit_req zone=req_limit burst=10 nodelay;

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö User-Agent
if ($http_user_agent ~* (bot|crawler|spider)) {
    return 403;
}

# –ó–∞—â–∏—Ç–∞ –æ—Ç Slowloris
client_body_timeout 10s;
client_header_timeout 10s;
keepalive_timeout 10s;
send_timeout 10s;

# –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–æ–≤
client_body_buffer_size 1K;
client_header_buffer_size 1k;
client_max_body_size 1m;
large_client_header_buffers 2 1k;
```

### CORS Configuration

```javascript
// src/middleware/cors-security.js

const corsOptions = {
  origin: function (origin, callback) {
    const allowedOrigins = [
      'https://ai-admin.app',
      'https://yclients.com',
      'https://*.yclients.com'
    ];

    // –†–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ origin (–Ω–∞–ø—Ä–∏–º–µ—Ä, Postman)
    if (!origin && process.env.NODE_ENV === 'development') {
      return callback(null, true);
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ origin
    const isAllowed = allowedOrigins.some(allowed => {
      if (allowed.includes('*')) {
        const regex = new RegExp(allowed.replace('*', '.*'));
        return regex.test(origin);
      }
      return allowed === origin;
    });

    if (isAllowed) {
      callback(null, true);
    } else {
      logger.warn(`Blocked CORS request from ${origin}`);
      callback(new Error('Not allowed by CORS'));
    }
  },
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE'],
  allowedHeaders: ['Content-Type', 'Authorization', 'X-API-Key'],
  exposedHeaders: ['X-RateLimit-Remaining', 'X-RateLimit-Reset'],
  maxAge: 86400 // 24 —á–∞—Å–∞
};
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Production Environment Variables

```bash
# .env.production

# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
NODE_ENV=production
JWT_SECRET=your_very_secure_random_string_min_32_chars
DATABASE_URL=postgresql://user:password@localhost/db?ssl=true
REDIS_URL=redis://:password@localhost:6379
SUPABASE_URL=https://project.supabase.co
SUPABASE_KEY=your_service_role_key_keep_secret

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
BCRYPT_ROUNDS=12
SESSION_SECRET=another_secure_random_string
COOKIE_SECURE=true
COOKIE_HTTPONLY=true
COOKIE_SAMESITE=strict

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=30

# Logging
LOG_LEVEL=info
LOG_FILE=/var/log/ai-admin/app.log
ERROR_LOG_FILE=/var/log/ai-admin/error.log

# Monitoring
SENTRY_DSN=https://key@sentry.io/project
NEW_RELIC_LICENSE_KEY=your_license_key
```

### Security Headers

```javascript
// src/middleware/security-headers.js

const helmet = require('helmet');

app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: ["'self'", "'unsafe-inline'", "https://cdn.socket.io"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      imgSrc: ["'self'", "data:", "https:"],
      connectSrc: ["'self'", "wss:", "https:"],
      fontSrc: ["'self'"],
      objectSrc: ["'none'"],
      mediaSrc: ["'self'"],
      frameSrc: ["'none'"],
    },
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
app.use((req, res, next) => {
  res.setHeader('X-Content-Type-Options', 'nosniff');
  res.setHeader('X-Frame-Options', 'DENY');
  res.setHeader('X-XSS-Protection', '1; mode=block');
  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');
  res.setHeader('Permissions-Policy', 'geolocation=(), microphone=(), camera=()');
  next();
});
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
  - [ ] JWT_SECRET —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
  - [ ] NODE_ENV=production
  - [ ] –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ .env, –Ω–µ –≤ –∫–æ–¥–µ

- [ ] **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
  - [ ] `npm audit` - –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
  - [ ] –í—Å–µ –ø–∞–∫–µ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
  - [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã

- [ ] **–ö–æ–¥**
  - [ ] –ù–µ—Ç console.log —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  - [ ] –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
  - [ ] SQL –∑–∞–ø—Ä–æ—Å—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ã
  - [ ] –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ —Ç–æ–∫–µ–Ω–æ–≤/–ø–∞—Ä–æ–ª–µ–π

- [ ] **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
  - [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] Security headers —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
  - [ ] CORS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
  - [ ] Rate limiting –∞–∫—Ç–∏–≤–µ–Ω

- [ ] **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
  - [ ] SSL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
  - [ ] –ü–∞—Ä–æ–ª–∏ –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞–Ω—ã (bcrypt)
  - [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
  - [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã

- [ ] **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
  - [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
  - [ ] –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
  - [ ] –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
  - [ ] Error tracking –ø–æ–¥–∫–ª—é—á–µ–Ω

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

- [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
  ```bash
  # –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL
  nmap --script ssl-cert,ssl-enum-ciphers -p 443 ai-admin.app

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
  curl -I https://ai-admin.app

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SQL injection
  sqlmap -u "https://ai-admin.app/api/endpoint?id=1" --batch

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ XSS
  dalfox url https://ai-admin.app
  ```

- [ ] **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backup –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

## üöë –ò–Ω—Ü–∏–¥–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç

### –ü–ª–∞–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

#### 1. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑—ã

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
class SecurityMonitor {
  detectAnomalies() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±—Ä—É—Ç—Ñ–æ—Ä—Å
    if (failedLogins > 10) {
      this.triggerAlert('BRUTE_FORCE_DETECTED');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ SQL injection –ø–æ–ø—ã—Ç–∫–∏
    if (request.includes('UNION') || request.includes('SELECT')) {
      this.triggerAlert('SQL_INJECTION_ATTEMPT');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫
    if (requestsPerMinute > 1000) {
      this.triggerAlert('DDOS_ATTACK');
    }
  }

  triggerAlert(type) {
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    logger.error(`SECURITY ALERT: ${type}`, {
      timestamp: new Date(),
      ip: request.ip,
      url: request.url
    });

    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
    sendEmail({
      to: 'security@ai-admin.app',
      subject: `Security Alert: ${type}`,
      priority: 'high'
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
    if (type === 'BRUTE_FORCE_DETECTED' || type === 'SQL_INJECTION_ATTEMPT') {
      blockIP(request.ip);
    }
  }
}
```

#### 2. –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ–±–ª–µ–º—ã

```bash
#!/bin/bash
# emergency-response.sh

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP —á–µ—Ä–µ–∑ iptables
block_ip() {
  iptables -A INPUT -s $1 -j DROP
  echo "Blocked IP: $1"
}

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
disable_account() {
  psql $DATABASE_URL -c "UPDATE companies SET active=false WHERE id=$1;"
  redis-cli DEL "session:company:$1"
  echo "Disabled account: $1"
}

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏—è
readonly_mode() {
  # Nginx - —Ç–æ–ª—å–∫–æ GET –∑–∞–ø—Ä–æ—Å—ã
  nginx -s reload -c /etc/nginx/readonly.conf

  # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö POST/PUT/DELETE
  echo "System in read-only mode"
}

# –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è
emergency_shutdown() {
  # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  pm2 stop all

  # –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫—Ä–æ–º–µ SSH
  iptables -P INPUT DROP
  iptables -A INPUT -p tcp --dport 22 -j ACCEPT

  echo "EMERGENCY: System isolated"
}
```

#### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

# 1. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
grep -E "ERROR|WARN|SECURITY" /var/log/ai-admin/*.log > incident_report.txt

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
psql $DATABASE_URL -c "SELECT COUNT(*) FROM companies WHERE updated_at > NOW() - INTERVAL '1 hour';"

# 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
pg_restore -d ai_admin backup_before_incident.sql

# 4. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
redis-cli FLUSHALL

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
pm2 restart ecosystem.config.js

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
curl https://ai-admin.app/health
```

### –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π

```yaml
security_team:
  lead:
    name: Security Lead
    phone: +7-900-000-00-00
    email: security@ai-admin.app

  backend:
    name: Backend Lead
    phone: +7-900-000-00-01
    email: backend@ai-admin.app

  devops:
    name: DevOps Lead
    phone: +7-900-000-00-02
    email: devops@ai-admin.app

external:
  hosting:
    company: DigitalOcean
    support: +1-800-000-0000
    ticket: support.digitalocean.com

  database:
    company: Supabase
    support: support@supabase.io
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### KPI –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```javascript
// –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏
const securityMetrics = {
  // –ü–æ–ø—ã—Ç–∫–∏ –∞—Ç–∞–∫
  sqlInjectionAttempts: 0,
  xssAttempts: 0,
  bruteForceAttempts: 0,

  // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  blockedIPs: new Set(),
  rateLimitHits: 0,

  // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  failedLogins: 0,
  successfulLogins: 0,
  tokenValidationErrors: 0,

  // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞—â–∏—Ç—ã
  avgValidationTime: 0,
  avgRateLimitCheckTime: 0
};

// –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
app.get('/metrics/security', authenticateAdmin, (req, res) => {
  res.json({
    timestamp: new Date(),
    metrics: securityMetrics,
    health: calculateSecurityHealth(securityMetrics)
  });
});
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **[OWASP ZAP](https://www.zaproxy.org/)** - –°–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **[Snyk](https://snyk.io/)** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **[SSL Labs](https://www.ssllabs.com/ssltest/)** - –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL
- **[Security Headers](https://securityheaders.com/)** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Node.js Security Checklist](https://blog.risingstack.com/node-js-security-checklist/)
- [Express Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)
- [JWT Best Practices](https://tools.ietf.org/html/rfc8725)

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 16 —è–Ω–≤–∞—Ä—è 2025*
*–í–µ—Ä—Å–∏—è: 1.0.0*
*–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ*