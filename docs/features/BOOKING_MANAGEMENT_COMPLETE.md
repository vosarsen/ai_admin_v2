# –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∑–∞–ø–∏—Å—è–º–∏

## –û–±–∑–æ—Ä

AI Admin v2 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—è–º–∏ —á–µ—Ä–µ–∑ WhatsApp:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏** (CREATE_BOOKING) - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
2. **–û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏** (CANCEL_BOOKING) - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
3. **–ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏** (RESCHEDULE_BOOKING) - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
4. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏** (CONFIRM_BOOKING) - üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
5. **–û—Ç–º–µ—Ç–∫–∞ –æ –Ω–µ—è–≤–∫–µ** (MARK_NO_SHOW) - üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏

### –ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:
- "–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –°–µ—Ä–≥–µ—é –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
- "–ó–∞–ø–∏—à–∏—Ç–µ –º–µ–Ω—è –Ω–∞ –º–∞–Ω–∏–∫—é—Ä"
- "–ú–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∑–∞–≤—Ç—Ä–∞?"

### –ü—Ä–æ—Ü–µ—Å—Å:
1. AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Å–ª—É–≥—É, –º–∞—Å—Ç–µ—Ä–∞, –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–ª–æ—Ç–∞
3. –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ YClients
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –¥–µ—Ç–∞–ª—è–º–∏
5. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
```http
POST /api/v1/book_record/962302
{
  "phone": "79001234567",
  "fullname": "–ù–∏–∫–æ–ª–∞–π",
  "email": "",
  "comment": "–ó–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ AI –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ WhatsApp",
  "appointments": [{
    "id": 1,
    "services": [18356010],
    "staff_id": 2895125,
    "datetime": "2025-07-29 15:00:00"
  }]
}
```

## 2. –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏

### –ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:
- "–•–æ—á—É –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å"
- "–û—Ç–º–µ–Ω–∏—Ç–µ –º–æ—é –∑–∞–ø–∏—Å—å"
- "–ù–µ —Å–º–æ–≥—É –ø—Ä–∏–π—Ç–∏"

### –ü—Ä–æ—Ü–µ—Å—Å:
1. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –∞–∫—Ç–∏–≤–Ω—É—é –∑–∞–ø–∏—Å—å –∫–ª–∏–µ–Ω—Ç–∞
2. –ü–æ–ª—É—á–∞–µ—Ç visit_id —á–µ—Ä–µ–∑ GET /record/{company_id}/{record_id}
3. –ú–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ "–Ω–µ –ø—Ä–∏—à–µ–ª" —á–µ—Ä–µ–∑ PUT /visits/{visit_id}/{record_id}
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–º–µ–Ω—ã

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
```http
# –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ visit_id
GET /api/v1/record/962302/1211188650

# –®–∞–≥ 2: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
PUT /api/v1/visits/1050341497/1211188650
{
  "attendance": -1
}
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ó–∞–ø–∏—Å—å –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏
- –ü–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–∫–ª–∏–µ–Ω—Ç –Ω–µ –ø—Ä–∏—à–µ–ª"
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

## 3. –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏

### –ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:
- "–•–æ—á—É –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∑–∞–ø–∏—Å—å –Ω–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 16:00"
- "–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏?"
- "–ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –Ω–∞ –¥—Ä—É–≥–æ–π –¥–µ–Ω—å"

### –ü—Ä–æ—Ü–µ—Å—Å:
1. –ù–∞—Ö–æ–¥–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞
2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –¥–∞—Ç—É/–≤—Ä–µ–º—è (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã)
3. –ü—Ä–æ–±—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–Ω–æ—Å–∞
4. –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

#### –ú–µ—Ç–æ–¥ 1 (–æ—Å–Ω–æ–≤–Ω–æ–π):
```http
PUT /api/v1/book_record/962302/1211188650
{
  "datetime": "2025-07-29T16:00:00",
  "comment": "–ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ WhatsApp –±–æ—Ç–∞"
}
```

#### –ú–µ—Ç–æ–¥ 2 (fallback):
```http
PUT /api/v1/record/962302/1211188650
{
  "datetime": "2025-07-29T16:00:00",
  "staff_id": 2895125,
  "services": [{
    "id": 18356010,
    "cost": 1000,
    "discount": 0
  }],
  "client": {
    "phone": "79001234567",
    "name": "–ù–∏–∫–æ–ª–∞–π"
  }
}
```

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞:
```http
GET /api/v1/records/962302?client_phone=79001234567
```

### 2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã–±–æ—Ä–∞ –∑–∞–ø–∏—Å–∏:
- –ë–µ—Ä–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è (—Å–∞–º–∞—è –Ω–æ–≤–∞—è) –∞–∫—Ç–∏–≤–Ω–∞—è –∑–∞–ø–∏—Å—å
- –§–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –±—É–¥—É—â–∏–µ –∑–∞–ø–∏—Å–∏
- –ü—Ä–æ—à–µ–¥—à–∏–µ –∑–∞–ø–∏—Å–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã
- –ü—Ä–∏ –Ω–µ—É–¥–∞—á–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
  - –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ YClients
  - –°–∞–π—Ç yclients.com
  - –ó–≤–æ–Ω–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

### 4. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤:
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —ç–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω –æ–±—â–µ–Ω–∏—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
grep "Booking created successfully" /opt/ai-admin/logs/worker-v2-out.log

# –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏
grep "Successfully soft-cancelled record" /opt/ai-admin/logs/worker-v2-out.log

# –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏
grep "Successfully rescheduled booking" /opt/ai-admin/logs/worker-v2-out.log
```

### –õ–æ–≥–∏ –æ—à–∏–±–æ–∫:
```bash
# –û–±—â–∏–µ –æ—à–∏–±–∫–∏ –∫–æ–º–∞–Ω–¥
grep "Command .* failed" /opt/ai-admin/logs/worker-v2-error.log

# –ü—Ä–æ–±–ª–µ–º—ã —Å YClients API
grep "YClients API error" /opt/ai-admin/logs/worker-v2-error.log
```

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ YClients

–î–ª—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∞:
- ‚úÖ –ß—Ç–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å–ª—É–≥
- ‚úÖ –ß—Ç–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –ß—Ç–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

**–í–∞–∂–Ω–æ**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Partner-Id: 8444`

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–í—ã–±–æ—Ä –∑–∞–ø–∏—Å–∏**: –ü—Ä–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ú–∞—Å—Ç–µ—Ä –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
4. **–ò—Å—Ç–æ—Ä–∏—è**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
5. **AI —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ**: –ù–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏** –∏–∑ —Å–ø–∏—Å–∫–∞
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–Ω–æ—Å–æ–º
3. **Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –º–∞—Å—Ç–µ—Ä–∞–º
4. **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π** –¥–ª—è –∞—É–¥–∏—Ç–∞
5. **–ì—Ä—É–ø–ø–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (–æ—Ç–º–µ–Ω–∞ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π)
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏** (Google, Apple)
7. **–ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∑–∞–ø–∏—Å—è–º–∏

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å—å—é:
```
1. "–ó–∞–ø–∏—à–∏ –º–µ–Ω—è –∫ –°–µ—Ä–≥–µ—é –Ω–∞ —Å—Ç—Ä–∏–∂–∫—É –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
   ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏

2. "–•–æ—á—É –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∑–∞–ø–∏—Å—å –Ω–∞ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞ –≤ 17:00"
   ‚Üí –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏

3. "–û—Ç–º–µ–Ω–∏ –º–æ—é –∑–∞–ø–∏—Å—å"
   ‚Üí –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏
```

### Edge cases –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –ü–µ—Ä–µ–Ω–æ—Å –Ω–∞ –∑–∞–Ω—è—Ç–æ–µ –≤—Ä–µ–º—è
- –û—Ç–º–µ–Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ø—Ä–æ—à–ª–æ–º
- –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —É –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞