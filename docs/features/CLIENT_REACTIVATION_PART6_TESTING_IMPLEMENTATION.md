# Client Reactivation System - Part 6: Testing & Implementation Guide

## üß™ Testing Strategy

### Unit Tests

#### 1. Preference Analyzer Tests

```javascript
// tests/services/client-reactivation/preference-analyzer.test.js

const PreferenceAnalyzer = require('../../../src/services/client-reactivation/detectors/preference-analyzer');

describe('PreferenceAnalyzer', () => {
  let analyzer;

  beforeEach(() => {
    analyzer = new PreferenceAnalyzer();
  });

  describe('analyzeTimePreferences', () => {
    it('should detect morning preference', () => {
      const history = [
        { datetime: '2025-10-01T10:00:00Z' },
        { datetime: '2025-10-08T10:30:00Z' },
        { datetime: '2025-10-15T11:00:00Z' },
        { datetime: '2025-10-22T10:15:00Z' }
      ];

      const result = analyzer.analyzeTimePreferences(history);

      expect(result.preferred).toBe('morning');
      expect(result.confidence).toBeGreaterThan(0.8);
    });

    it('should detect mixed preferences', () => {
      const history = [
        { datetime: '2025-10-01T10:00:00Z' },  // Morning
        { datetime: '2025-10-08T14:00:00Z' },  // Afternoon
        { datetime: '2025-10-15T18:00:00Z' }   // Evening
      ];

      const result = analyzer.analyzeTimePreferences(history);

      expect(result.preferred).toBeNull();
      expect(result.confidence).toBeLessThan(0.5);
    });
  });

  describe('analyzeStaffPreferences', () => {
    it('should identify favorite staff', () => {
      const history = [
        { staff_id: 1, staff_name: '–ò–≤–∞–Ω' },
        { staff_id: 1, staff_name: '–ò–≤–∞–Ω' },
        { staff_id: 1, staff_name: '–ò–≤–∞–Ω' },
        { staff_id: 2, staff_name: '–ú–∞—Ä–∏—è' }
      ];

      const result = analyzer.analyzeStaffPreferences(history);

      expect(result.favoriteStaffId).toBe(1);
      expect(result.favoriteStaffName).toBe('–ò–≤–∞–Ω');
      expect(result.percentage).toBe(75);
    });
  });
});
```

#### 2. Slot Finder Tests

```javascript
// tests/services/client-reactivation/slot-finder.test.js

const SlotFinder = require('../../../src/services/client-reactivation/generators/slot-finder');

describe('SlotFinder', () => {
  let finder;

  beforeEach(() => {
    finder = new SlotFinder();
  });

  describe('rankSlots', () => {
    it('should prioritize favorite staff', () => {
      const slots = [
        {
          datetime: new Date('2025-10-22T14:00:00Z'),
          staffId: 1,
          staffName: '–ò–≤–∞–Ω'
        },
        {
          datetime: new Date('2025-10-22T10:00:00Z'),
          staffId: 2,
          staffName: '–ú–∞—Ä–∏—è'
        }
      ];

      const preferences = {
        staffPreferences: {
          favoriteStaffId: 1,
          confidence: 0.9
        },
        timePreferences: {
          preferred: 'morning',
          confidence: 0.7
        }
      };

      const ranked = finder.rankSlots(slots, preferences);

      // –õ—é–±–∏–º—ã–π –º–∞—Å—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–≤—ã–º, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–µ
      expect(ranked[0].staffId).toBe(1);
      expect(ranked[0].score).toBeGreaterThan(ranked[1].score);
    });
  });
});
```

### Integration Tests

```javascript
// tests/integration/reactivation-flow.test.js

describe('Reactivation Flow', () => {
  it('should complete full reactivation cycle', async () => {
    // 1. Setup: Create test client with history
    const client = await createTestClient({
      phone: '79001234567',
      visitCount: 5,
      lastVisit: '2025-09-01',  // 50 days ago
      loyaltyLevel: 'Silver'
    });

    // 2. Create service rule
    await createServiceRule({
      serviceId: 123,
      intervalDays: 30,
      discountProgression: [10, 15]
    });

    // 3. Run detector
    const detector = new InactivityDetector();
    const eligible = await detector.findEligibleClients();

    expect(eligible).toContainEqual(
      expect.objectContaining({ phone: client.phone })
    );

    // 4. Run campaign manager
    const manager = new CampaignManager();
    const result = await manager.processClient(eligible[0]);

    expect(result.success).toBe(true);
    expect(result.campaignId).toBeDefined();

    // 5. Verify campaign saved
    const { data: campaign } = await supabase
      .from('reactivation_campaigns')
      .select('*')
      .eq('id', result.campaignId)
      .single();

    expect(campaign).toBeDefined();
    expect(campaign.discount_offered).toBe(10);
    expect(campaign.message_text).toBeTruthy();

    // 6. Verify context updated
    const context = await contextService.getContext(client.phone);

    expect(context.lastSystemAction.type).toBe('reactivation');
    expect(context.expectingResponse).toBe(true);

    // 7. Simulate positive response
    await responseTracker.trackResponse(
      client.phone,
      '–î–∞, –∑–∞–ø–∏—Å–∞—Ç—å',
      { bookingCreated: false }
    );

    // 8. Verify campaign updated
    const { data: updatedCampaign } = await supabase
      .from('reactivation_campaigns')
      .select('*')
      .eq('id', result.campaignId)
      .single();

    expect(updatedCampaign.response_type).toBe('positive');
  });
});
```

### E2E Tests (With MCP Servers)

```javascript
// tests/e2e/reactivation-e2e.test.js

describe('Reactivation E2E', () => {
  const TEST_PHONE = '89686484488';  // –¢–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä

  beforeEach(async () => {
    // –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    await mcp.whatsapp.clear_test_data({ phone: TEST_PHONE });
    await mcp.redis.clear_context({ phone: TEST_PHONE });
  });

  it('should send reactivation and handle booking', async () => {
    // 1. –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
    await setupInactiveClient(TEST_PHONE, {
      lastVisit: '2025-08-15',
      service: '–°—Ç—Ä–∏–∂–∫–∞'
    });

    // 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é
    const response = await fetch('http://localhost:3000/api/reactivation/campaigns/manual', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        company_id: 962302,
        client_phone: TEST_PHONE,
        service_id: 123
      })
    });

    const result = await response.json();
    expect(result.success).toBe(true);

    // 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
    const conversation = await mcp.whatsapp.get_conversation({
      phone: TEST_PHONE,
      last_messages: 1
    });

    expect(conversation.messages[0].from).toBe('bot');
    expect(conversation.messages[0].text).toContain('–¥–Ω–µ–π');  // –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏

    // 4. –ö–ª–∏–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
    await mcp.whatsapp.send_message({
      phone: TEST_PHONE,
      message: '–î–∞, –∑–∞–ø–∏—Å–∞—Ç—å'
    });

    // 5. –ñ–¥–µ–º –æ—Ç–≤–µ—Ç–∞ AI
    await sleep(10000);  // 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É

    const lastResponse = await mcp.whatsapp.get_last_response({
      phone: TEST_PHONE
    });

    expect(lastResponse).toContain('–∫–∞–∫—É—é —É—Å–ª—É–≥—É' | '–∫–∞–∫–æ–µ –≤—Ä–µ–º—è');

    // 6. –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–ø–∏—Å—å
    await mcp.whatsapp.send_message({
      phone: TEST_PHONE,
      message: '–°—Ç—Ä–∏–∂–∫–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 14:00'
    });

    await sleep(10000);

    // 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞
    const bookings = await mcp.supabase.query_table({
      table: 'bookings',
      filters: { client_phone: TEST_PHONE },
      orderBy: { column: 'created_at', ascending: false },
      limit: 1
    });

    expect(bookings.length).toBeGreaterThan(0);

    // 8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–∞–º–ø–∞–Ω–∏—è –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ converted
    const campaigns = await mcp.supabase.query_table({
      table: 'reactivation_campaigns',
      filters: { client_phone: TEST_PHONE },
      orderBy: { column: 'sent_at', ascending: false },
      limit: 1
    });

    expect(campaigns[0].booking_created).toBe(true);
    expect(campaigns[0].response_type).toBe('booking_created');
  });

  it('should handle opt-out', async () => {
    // Setup
    await setupInactiveClient(TEST_PHONE);

    // Send reactivation
    await sendReactivation(TEST_PHONE);

    // Client opts out
    await mcp.whatsapp.send_message({
      phone: TEST_PHONE,
      message: '–ù–µ –Ω–∞–¥–æ –º–Ω–µ –ø–∏—Å–∞—Ç—å'
    });

    await sleep(5000);

    // Verify client marked as opt-out
    const client = await mcp.supabase.query_table({
      table: 'clients',
      filters: { phone: TEST_PHONE },
      limit: 1
    });

    expect(client[0].reactivation_opt_out).toBe(true);
  });
});
```

---

## üìã Implementation Checklist

### Phase 1: Foundation (Week 1)

- [ ] **Database Migration**
  - [ ] Create `service_reactivation_rules` table
  - [ ] Create `reactivation_campaigns` table
  - [ ] Create `whatsapp_account_health` table
  - [ ] Create `reactivation_settings` table
  - [ ] Add columns to `clients` table
  - [ ] Create indexes
  - [ ] Create SQL functions (increment_whatsapp_counters)
  - [ ] Run migration on production

- [ ] **Configuration**
  - [ ] Create `config/reactivation-config.js`
  - [ ] Add environment variables to `.env`
  - [ ] Set up default values for all companies
  - [ ] Initialize WhatsApp health for all companies

- [ ] **Core Services - Basic Structure**
  - [ ] Create directory structure
  - [ ] Implement `scheduler.js`
  - [ ] Implement `InactivityDetector`
  - [ ] Implement `PreferenceAnalyzer`
  - [ ] Add unit tests for each component

### Phase 2: Core Functionality (Week 2)

- [ ] **Slot Finding & AI Generation**
  - [ ] Implement `SlotFinder`
  - [ ] Implement `AIMessageGenerator`
  - [ ] Test AI prompt with real data
  - [ ] Optimize prompt for best results
  - [ ] Implement fallback templates

- [ ] **Campaign Management**
  - [ ] Implement `CampaignManager`
  - [ ] Implement `LimitManager`
  - [ ] Test full campaign flow
  - [ ] Add error handling

- [ ] **Response Tracking**
  - [ ] Implement `ResponseTracker`
  - [ ] Integrate with AI Admin message handler
  - [ ] Test response classification
  - [ ] Test opt-out handling

### Phase 3: Integration (Week 3)

- [ ] **Context Integration**
  - [ ] Update Redis context on campaign send
  - [ ] Add reactivation info to AI prompts
  - [ ] Handle preference changes during dialog
  - [ ] Test long-term memory

- [ ] **Booking Monitor Integration**
  - [ ] Detect bookings created after reactivation
  - [ ] Attribute bookings to campaigns
  - [ ] Calculate conversion metrics

- [ ] **WhatsApp Safety**
  - [ ] Implement health monitoring
  - [ ] Implement limit checking
  - [ ] Add ban detection
  - [ ] Add alerts for issues

### Phase 4: API & UI (Week 4)

- [ ] **API Endpoints**
  - [ ] Settings CRUD
  - [ ] Service rules CRUD
  - [ ] Stats & analytics
  - [ ] Campaign management
  - [ ] WhatsApp health

- [ ] **Frontend (Optional)**
  - [ ] Settings page
  - [ ] Service rules editor
  - [ ] Dashboard with stats
  - [ ] Campaign list

### Phase 5: Analytics & Optimization (Week 5)

- [ ] **Conversion Analyzer**
  - [ ] Implement all metrics
  - [ ] Best times analysis
  - [ ] ROI calculation
  - [ ] Reports generation

- [ ] **Interval Calculator**
  - [ ] Calculate optimal intervals from history
  - [ ] AI suggestions for intervals
  - [ ] Auto-optimization

- [ ] **A/B Testing Framework**
  - [ ] Test different discount progressions
  - [ ] Test different messages tones
  - [ ] Test different slot offerings

### Phase 6: Testing & Deployment (Week 6)

- [ ] **Testing**
  - [ ] Unit tests (80%+ coverage)
  - [ ] Integration tests
  - [ ] E2E tests with test phone
  - [ ] Load testing

- [ ] **Documentation**
  - [ ] User guide for clients
  - [ ] Admin guide
  - [ ] API documentation
  - [ ] Troubleshooting guide

- [ ] **Deployment**
  - [ ] Deploy to staging
  - [ ] Test with real data (1-2 companies)
  - [ ] Monitor for 1 week
  - [ ] Fix issues
  - [ ] Gradual rollout to all companies

---

## üöÄ Deployment Steps

### 1. Preparation

```bash
# 1. Backup database
ssh -i ~/.ssh/id_ed25519_ai_admin root@46.149.70.219
cd /opt/ai-admin
pg_dump -U postgres ai_admin_v2 > backup_before_reactivation.sql

# 2. Pull latest code
git pull origin feature/client-reactivation

# 3. Install dependencies
npm install
```

### 2. Database Migration

```bash
# Run migrations
npm run migrate:reactivation

# Verify tables created
psql -U postgres -d ai_admin_v2 -c "\dt reactivation*"

# Initialize data
npm run init:reactivation-data
```

### 3. Configuration

```bash
# Add to .env
cat >> .env << 'EOF'
REACTIVATION_ENABLED=true
REACTIVATION_CRON="0 10 * * *"
REACTIVATION_DEBUG=false
EOF

# Restart services
pm2 restart all
```

### 4. Testing

```bash
# Test manual campaign
curl -X POST http://localhost:3000/api/reactivation/campaigns/manual \
  -H "Content-Type: application/json" \
  -d '{
    "company_id": 962302,
    "client_phone": "89686484488",
    "service_id": 123
  }'

# Check logs
pm2 logs ai-admin-worker-v2 --lines 100 | grep reactivation
```

### 5. Monitoring

```bash
# Watch scheduler
watch -n 60 "pm2 logs ai-admin-worker-v2 --lines 20 | grep 'reactivation check'"

# Check campaigns
curl http://localhost:3000/api/reactivation/stats/962302

# Monitor WhatsApp health
curl http://localhost:3000/api/reactivation/whatsapp-health/962302
```

---

## üéì Usage Guide for Clients

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –°–∏—Å—Ç–µ–º—ã –†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏

#### 1. –û–±—â–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤**.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **–í–∫–ª—é—á–µ–Ω–æ**: –í–∫–ª/–í—ã–∫–ª —Å–∏—Å—Ç–µ–º—É —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- **–¢–æ–Ω —Å–æ–æ–±—â–µ–Ω–∏–π**: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π / –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π / –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π
- **–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏**: –° 10:00 –¥–æ 19:00 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **–î–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏**: –ü–Ω-–ü—Ç (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –£—Å–ª—É–≥

–î–ª—è –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

**–°—Ç—Ä–∏–∂–∫–∞:**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏: 28 –¥–Ω–µ–π
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑: 14 –¥–Ω–µ–π
- –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫: 3
- –°–∫–∏–¥–∫–∏: 10%, 15%, 20%

**–û–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ:**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: 45 –¥–Ω–µ–π
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞: 14 –¥–Ω–µ–π
- –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫: 2
- –°–∫–∏–¥–∫–∏: 10%, 15%

**–ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª:**
1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–∫–Ω–æ–ø–∫–∞ "–ê–Ω–∞–ª–∏–∑")
2. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –≤–∏–∑–∏—Ç–∞–º–∏
3. –ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI-–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (–∫–Ω–æ–ø–∫–∞ "–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é")
4. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é

#### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í —Ä–∞–∑–¥–µ–ª–µ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Üí –†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è** –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- –°–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –∑–∞–ø–∏—Å–∏
- ROI (–≤–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π)
- –õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- –ï—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è < 10% - —É–≤–µ–ª–∏—á—å—Ç–µ —Å–∫–∏–¥–∫–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Ç–æ–Ω
- –ï—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—è > 20% - –º–æ–∂–µ—Ç–µ —É–º–µ–Ω—å—à–∏—Ç—å —Å–∫–∏–¥–∫–∏
- –°–º–æ—Ç—Ä–∏—Ç–µ "–õ—É—á—à–µ–µ –≤—Ä–µ–º—è" –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —á–∞—Å—ã –æ—Ç–ø—Ä–∞–≤–∫–∏

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å scheduler
pm2 logs ai-admin-worker-v2 | grep "reactivation check"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
curl http://localhost:3000/api/reactivation/whatsapp-health/962302

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å eligible clients
# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Found X eligible clients"
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–æ
- –î–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç
- –ù–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–µ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
- WhatsApp –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è

**–ê–Ω–∞–ª–∏–∑:**
```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl http://localhost:3000/api/reactivation/stats/962302?period=month
```

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–ª–∏—à–∫–æ–º —Ñ–æ—Ä–º–∞–ª—å–Ω–æ/–Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ?)
2. –£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–∏–¥–∫–∏
3. –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –±–æ–ª—å—à–µ —Å–ª–æ—Ç–æ–≤
4. –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –±–æ–ª–µ–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω–æ–µ

### –ü—Ä–æ–±–ª–µ–º–∞: AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–ª–æ—Ö–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–ø—Ç –≤ –ª–æ–≥–∞—Ö
2. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø—Ä–æ–º–ø—Ç
3. –ò–∑–º–µ–Ω–∏—Ç—å temperature (—Å–µ–π—á–∞—Å 0.7)
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback templates

---

## üìà Success Metrics

**KPI –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**

1. **Conversion Rate**: > 15%
2. **Response Rate**: > 30%
3. **ROI**: > 3x
4. **Avg Response Time**: < 24 hours
5. **Opt-out Rate**: < 5%

**–§–æ—Ä–º—É–ª—ã:**
```
Conversion Rate = Bookings Created / Messages Sent
Response Rate = Responses Received / Messages Sent
ROI = Revenue from Reactivation / Cost of Reactivation
Opt-out Rate = Opt-outs / Messages Sent
```

---

**–ì–æ—Ç–æ–≤–æ!** –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏! üöÄ
