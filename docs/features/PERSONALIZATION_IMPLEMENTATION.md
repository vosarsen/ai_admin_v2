# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—â–µ–Ω–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

**–î–∞—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è**: 5 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –≤ production

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã)
4. [–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
5. [–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –≤ –¥–µ–π—Å—Ç–≤–∏–∏](#–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è-–≤-–¥–µ–π—Å—Ç–≤–∏–∏)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
7. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–º–µ—Ç—Ä–∏–∫–∏)
8. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
9. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
10. [–ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è](#–±—É–¥—É—â–∏–µ-—É–ª—É—á—à–µ–Ω–∏—è)

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ AI Admin v2 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –∏—Å—Ç–æ—Ä–∏–∏ –≤–∏–∑–∏—Ç–æ–≤, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ —Å—Ç–∞—Ç—É—Å–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞, –ø–æ–≤—ã—à–∞—è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—é –≤ –∑–∞–ø–∏—Å–∏.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- üé≠ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
- üí° –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É—Å–ª—É–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏
- üë• –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ª—é–±–∏–º—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤
- üèÜ –£—á–µ—Ç VIP —Å—Ç–∞—Ç—É—Å–∞ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- üìä –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ—Å–µ—â–µ–Ω–∏–π
- üéÅ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∫–∏–¥–∫–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- **1096 –∫–ª–∏–µ–Ω—Ç–æ–≤** —Å –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –≤–∏–∑–∏—Ç–æ–≤
- **100% –æ—Ö–≤–∞—Ç** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** 2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å
- **5 —É—Ä–æ–≤–Ω–µ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏**: New, Bronze, Silver, Gold, VIP

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û–±—â–∞—è —Å—Ö–µ–º–∞:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   WhatsApp      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  AI Admin v2     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏-   ‚îÇ
‚îÇ   –ö–ª–∏–µ–Ω—Ç        ‚îÇ     ‚îÇ  Message Worker  ‚îÇ     ‚îÇ  —Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                               ‚ñº
                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ Data Loading     ‚îÇ
                     ‚îÇ & Analysis       ‚îÇ
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚ñº                     ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  Supabase    ‚îÇ     ‚îÇ  YClients    ‚îÇ
           ‚îÇ  Database    ‚îÇ     ‚îÇ  API         ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è** ‚Üí –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
2. **–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** ‚Üí –ò—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤, –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, —Å—Ç–∞—Ç—É—Å
3. **–ê–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç–∞** ‚Üí –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞** ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è AI
5. **–û—Ç–≤–µ—Ç AI** ‚Üí –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
6. **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞** ‚Üí –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. ClientPersonalizationService
**–ü—É—Ç—å**: `src/services/personalization/client-personalization.js`

–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞:
- –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —É—Å–ª—É–≥ –∏ –º–∞—Å—Ç–µ—Ä–æ–≤
- –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```javascript
analyzeClient(client)           // –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç–∞
getGreeting(client, analysis)   // –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
getServiceRecommendations(...)  // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É—Å–ª—É–≥
getMasterRecommendations(...)   // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–æ–≤
getSpecialOffers(...)          // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
```

### 2. –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç
**–ü—É—Ç—å**: `src/services/ai-admin-v2/prompts/personalized-prompt.js`

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è AI, –≤–∫–ª—é—á–∞—é—â–∏–π:
- –ü–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
- –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü—Ä–∏–º–µ—Ä—ã –¥–∏–∞–ª–æ–≥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö

### 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
- `src/sync/client-records-sync.js` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π
- `src/sync/client-visits-sync.js` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥
- `scripts/universal-yclients-sync.js` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä
- `src/sync/sync-manager.js` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª—ã**:
- `src/config/sync-config.js` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `src/config/index.js` - –æ–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `.env` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìä –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ß—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è:

1. **–ò—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤** (`visit_history`)
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞
   - –£—Å–ª—É–≥–∏
   - –ú–∞—Å—Ç–µ—Ä
   - –°—Ç–æ–∏–º–æ—Å—Ç—å
   - –°—Ç–∞—Ç—É—Å (–ø—Ä–∏—à–µ–ª/–Ω–µ –ø—Ä–∏—à–µ–ª)

2. **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ**:
   - `visit_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–∑–∏—Ç–æ–≤
   - `last_services` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —É—Å–ª—É–≥
   - `total_spent` - –æ–±—â–∞—è –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–∞—è —Å—É–º–º–∞
   - `average_bill` - —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
   - `loyalty_level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
   - `first_visit_date` - –¥–∞—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–∑–∏—Ç–∞
   - `last_visit_date` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–∏–∑–∏—Ç–∞

### –ü—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**:
   ```javascript
   // SyncManager –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤ 04:00 –∏ 14:00 –ú–°–ö
   process.env.SYNC_CLIENT_VISITS = 'true';
   await this.syncClients();
   ```

2. **–†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**:
   ```bash
   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
   node scripts/test-client-records-sync.js +79001234567
   
   # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
   SYNC_CLIENT_VISITS=true node scripts/universal-yclients-sync.js clients
   ```

3. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**:
   ```bash
   # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–∞—Ç—á–∞–º–∏
   node scripts/incremental-client-sync.js
   ```

### API –ª–∏–º–∏—Ç—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:

- **YClients –ª–∏–º–∏—Ç—ã**: 200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É, 5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫—É–Ω–¥—É
- **–ë–∞—Ç—á–∏**: 75 –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫–∞–∂–¥—ã–µ 3 –º–∏–Ω—É—Ç—ã (—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
- **–ó–∞–¥–µ—Ä–∂–∫–∏**: 400–º—Å –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏—Å—Ç–æ—Ä–∏–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: 5 –º–∏–Ω—É—Ç –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞

## üé≠ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –≤ –¥–µ–π—Å—Ç–≤–∏–∏

### –¢–∏–ø—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π:

1. **–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç** (0 –≤–∏–∑–∏—Ç–æ–≤):
   ```
   "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –†–∞–¥ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –≤ –Ω–∞—à–µ–º –±–∞—Ä–±–µ—Ä—à–æ–ø–µ! 
   –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
   ```

2. **–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç** (2-5 –≤–∏–∑–∏—Ç–æ–≤):
   ```
   "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä! –†–∞–¥ —Å–Ω–æ–≤–∞ –≤–∞—Å –≤–∏–¥–µ—Ç—å!"
   ```

3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–π –∫–ª–∏–µ–Ω—Ç** (5+ –≤–∏–∑–∏—Ç–æ–≤):
   ```
   "–ü—Ä–∏–≤–µ—Ç, –ê–ª–µ–∫—Å–∞–Ω–¥—Ä! –ó–∞–ø–∏—Å–∞—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω–æ –∫ –ê–ª–∏?"
   ```

4. **VIP –∫–ª–∏–µ–Ω—Ç** (Gold/VIP —Å—Ç–∞—Ç—É—Å):
   ```
   "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–ª–µ–∫—Å–µ–π! –í–∞—à VIP —Å—Ç–∞—Ç—É—Å –¥–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤ –∑–∞–ø–∏—Å–∏. 
   –ü–æ–¥–æ–±—Ä–∞—Ç—å —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è?"
   ```

5. **–î–∞–≤–Ω–æ –Ω–µ –±—ã–ª** (60+ –¥–Ω–µ–π):
   ```
   "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –°–µ—Ä–≥–µ–π! –î–∞–≤–Ω–æ –Ω–µ –≤–∏–¥–µ–ª–∏—Å—å - —Å 15 –º–∞—Ä—Ç–∞! 
   –†–∞–¥—ã —á—Ç–æ –≤—ã —Å–Ω–æ–≤–∞ —Å –Ω–∞–º–∏."
   ```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É—Å–ª—É–≥:

AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç:

1. **–õ—é–±–∏–º—É—é —É—Å–ª—É–≥—É** (–µ—Å–ª–∏ >70% –≤–∏–∑–∏—Ç–æ–≤):
   ```
   "–ó–∞–ø–∏—Å–∞—Ç—å –≤–∞—Å –Ω–∞ –º—É–∂—Å–∫—É—é —Å—Ç—Ä–∏–∂–∫—É –∫–∞–∫ –æ–±—ã—á–Ω–æ?"
   ```

2. **–í—ã–±–æ—Ä –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö** (–µ—Å–ª–∏ —á–µ—Ä–µ–¥—É–µ—Ç —É—Å–ª—É–≥–∏):
   ```
   "–ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è - —Å—Ç—Ä–∏–∂–∫—É, –±–æ—Ä–æ–¥—É –∏–ª–∏ –≤—Å—ë –≤–º–µ—Å—Ç–µ?"
   ```

3. **–ù–æ–≤—ã–µ —É—Å–ª—É–≥–∏** (–¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤):
   ```
   "–£ –Ω–∞—Å –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–æ–≤–∞—è —É—Å–ª—É–≥–∞ - –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–µ –±—Ä–∏—Ç—å–µ. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?"
   ```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:

1. **–Æ–±–∏–ª–µ–π–Ω—ã–π –≤–∏–∑–∏—Ç**:
   ```
   "–≠—Ç–æ –≤–∞—à 10-–π –≤–∏–∑–∏—Ç –∫ –Ω–∞–º! –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∏–∂–∫–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π 20%!"
   ```

2. **–†–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è**:
   ```
   "–ú—ã —Å–∫—É—á–∞–ª–∏! –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å —Å–∫–∏–¥–∫–∞ 15% –Ω–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ"
   ```

3. **VIP –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏**:
   ```
   "–î–ª—è Gold –∫–ª–∏–µ–Ω—Ç–æ–≤ - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è"
   ```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
AI_PROMPT_VERSION=personalized-prompt

# –í–∫–ª—é—á–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏
SYNC_CLIENT_VISITS=true

# –õ–∏–º–∏—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
MAX_VISITS_SYNC_PER_RUN=75
SYNC_RECENT_DAYS=60
MIN_VISITS_TO_SYNC=1
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–¥–µ:

```javascript
// src/config/index.js
ai: {
  promptVersion: process.env.AI_PROMPT_VERSION || 'personalized-prompt',
  // ...
}

// src/config/sync-config.js
CLIENTS: {
  SYNC_VISIT_HISTORY: process.env.SYNC_CLIENT_VISITS === 'true' || false,
  MAX_VISITS_SYNC_PER_RUN: 75,
  SYNC_RECENT_DAYS: 60,
  MIN_VISITS_TO_SYNC: 1
}
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### Prometheus –º–µ—Ç—Ä–∏–∫–∏:

–°–∏—Å—Ç–µ–º–∞ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
- `ai_admin_message_processing_duration` - –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- `ai_admin_prompt_usage_total` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- `ai_admin_client_personalization_total` - —Ç–∏–ø—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
- `ai_admin_sync_operations_total` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫:

```bash
# Endpoint –¥–ª—è Prometheus
curl http://localhost:3000/api/metrics

# –õ–æ–≥–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
pm2 logs ai-admin-worker-v2 | grep "personalization"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
node scripts/manual-sync.js status

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º
node scripts/sync-all-visits.js --dry-run
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–µ—Ä–≤–∏—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞**:
   ```bash
   git pull origin feature/redis-context-cache
   npm install
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   echo "AI_PROMPT_VERSION=personalized-prompt" >> .env
   echo "SYNC_CLIENT_VISITS=true" >> .env
   ```

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**:
   ```bash
   # –ü–µ—Ä–≤–∏—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
   SYNC_CLIENT_VISITS=true MAX_VISITS_SYNC_PER_RUN=1000 \
   node scripts/universal-yclients-sync.js clients
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤**:
   ```bash
   pm2 restart ai-admin-worker-v2 --update-env
   ```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
git add -A
git commit -m "feat: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏"
git push origin feature/redis-context-cache

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@46.149.70.219
cd /opt/ai-admin
git pull
pm2 restart ai-admin-worker-v2
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. **–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç**:
   - –¢–µ–ª–µ—Ñ–æ–Ω: –ª—é–±–æ–π –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä
   - –û–∂–∏–¥–∞–µ—Ç—Å—è: –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

2. **VIP –∫–ª–∏–µ–Ω—Ç**:
   - –¢–µ–ª–µ—Ñ–æ–Ω: –∫–ª–∏–µ–Ω—Ç —Å 10+ –≤–∏–∑–∏—Ç–∞–º–∏
   - –û–∂–∏–¥–∞–µ—Ç—Å—è: —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

3. **–í–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π—Å—è –∫–ª–∏–µ–Ω—Ç**:
   - –¢–µ–ª–µ—Ñ–æ–Ω: –∫–ª–∏–µ–Ω—Ç –Ω–µ –±—ã–ª >60 –¥–Ω–µ–π
   - –û–∂–∏–¥–∞–µ—Ç—Å—è: "–¥–∞–≤–Ω–æ –Ω–µ –≤–∏–¥–µ–ª–∏—Å—å", —Å–∫–∏–¥–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
node test-direct-webhook.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞
pm2 logs ai-admin-worker-v2 --lines 50 | grep "Bot response"

# –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
node -e "
const service = require('./src/services/personalization/client-personalization');
const ps = new service();
// –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –ë–î –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
"
```

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:
1. **–£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏** - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
2. **–ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–∑–∏—Ç–∞
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è** - based on —Å—Ä–µ–¥–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≤–∏–∑–∏—Ç–æ–≤
4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏** - –±–∞–ª–ª—ã, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –ø–æ–¥–∞—Ä–∫–∏

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
1. **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM** –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ –∏ —Ç–µ–≥–æ–≤
3. **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –æ–±—Ä–∞—â–µ–Ω–∏–µ–º
4. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ü–ª–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏](CLIENT_PERSONALIZATION_PLAN.md)
- [–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤](client-history-sync.md)
- [–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏](OPTIMAL_CLIENT_SYNC_STRATEGY.md)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prometheus](prometheus-setup.md)
- [–î–Ω–µ–≤–Ω–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](development-diary/2025-08-05-client-history-sync.md)

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs ai-admin-worker-v2`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: `node scripts/manual-sync.js status`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ 5 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞ –¥–ª—è –≤–µ—Ä—Å–∏–∏ AI Admin v2.0*