# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Qwen –≤ AI Admin v2

## üìã –û–±–∑–æ—Ä

–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º –º–æ–¥–µ–ª–∏:
- **Qwen-Plus** - –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è 85% –∑–∞–ø—Ä–æ—Å–æ–≤ (1-2 —Å–µ–∫)
- **Qwen2.5-72B** - —É–º–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ (3-4 —Å–µ–∫)

## üõ†Ô∏è –®–∞–≥–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –í —Ñ–∞–π–ª .env
DASHSCOPE_API_KEY=sk-5903551cd419422cbf47ac6f9c6fa4ac

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
ENABLE_DEEPSEEK_FALLBACK=true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DeepSeek –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤
USE_ORIGINAL_AI=false           # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install axios colors --save
```

### 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:
src/services/ai/dashscope-provider.js
src/services/ai-admin-v2/ai-provider-adapter.js
src/services/ai-admin-v2/index-with-qwen.js
```

### 4. –û–±–Ω–æ–≤–∏—Ç–µ worker –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏

–í —Ñ–∞–π–ª–µ `src/workers/message-worker-v2.js`:

```javascript
// –ë—ã–ª–æ:
const AIAdminV2 = require('../services/ai-admin-v2');

// –°—Ç–∞–ª–æ:
const AIAdminV2 = require('../services/ai-admin-v2/index-with-qwen');
```

### 5. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# Commit –∏ push
git add -A
git commit -m "feat: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã Qwen"
git push

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@46.149.70.219
cd /opt/ai-admin
git pull
npm install

# –î–æ–±–∞–≤—å—Ç–µ API –∫–ª—é—á
echo "DASHSCOPE_API_KEY=sk-5903551cd419422cbf47ac6f9c6fa4ac" >> .env

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ worker
pm2 restart ai-admin-worker-v2
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ endpoint –≤ API:

```javascript
// –í src/api/routes/admin.js
router.get('/ai-stats', async (req, res) => {
  const AIAdminV2 = require('../../services/ai-admin-v2/index-with-qwen');
  const aiAdmin = new AIAdminV2();
  
  res.json(aiAdmin.getAIStats());
});
```

–û—Ç–≤–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
```json
{
  "total": 1000,
  "distribution": {
    "fast": "85.7%",
    "smart": "14.3%"
  },
  "models": {
    "qwen-plus": {
      "count": 857,
      "avgResponseTime": 1837,
      "successRate": "98.5%"
    },
    "qwen2.5-72b": {
      "count": 143,
      "avgResponseTime": 3224,
      "successRate": "99.2%"
    }
  },
  "estimatedMonthlyCost": {
    "daily": "$4.25",
    "monthly": "$127.50",
    "breakdown": {
      "fast": "$98.00/mo",
      "smart": "$29.50/mo"
    }
  }
}
```

## üß† –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —É–º–Ω—É—é –º–æ–¥–µ–ª—å –ø—Ä–∏:
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ ‚â• 5 –±–∞–ª–ª–æ–≤
- –î–ª–∏–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (200+ —Å–∏–º–≤–æ–ª–æ–≤) - 2 –±–∞–ª–ª–∞
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã - 2 –±–∞–ª–ª–∞
- –°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–æ—à–ª—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç - 3 –±–∞–ª–ª–∞
- –°–ª–æ–∂–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ - 2 –±–∞–ª–ª–∞
- –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ - 2 –±–∞–ª–ª–∞
- –£—Å–ª–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ - 2 –±–∞–ª–ª–∞

## üí∞ –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç

–ü—Ä–∏ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å:
- **–°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ (DeepSeek)**: $255/–º–µ—Å—è—Ü
- **–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (Qwen)**: ~$127/–º–µ—Å—è—Ü
- **–≠–∫–æ–Ω–æ–º–∏—è**: $128/–º–µ—Å—è—Ü (50%)

–ü–ª—é—Å:
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 4-7 —Ä–∞–∑
- –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å–ª–æ–∂–Ω–æ—Å—Ç—å

## üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
node test-dual-qwen-system.js
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ production
```bash
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
node test-direct-webhook.js

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
pm2 logs ai-admin-worker-v2 --lines 100 | grep "Using"
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **API –∫–ª—é—á** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á DashScope –∞–∫—Ç–∏–≤–µ–Ω
2. **Fallback** - DeepSeek –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–µ—Ä–≤—ã–µ –¥–Ω–∏
4. **A/B —Ç–µ—Å—Ç** - –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º–æ–π

## üö® –û—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

```bash
# –í src/workers/message-worker-v2.js –≤–µ—Ä–Ω–∏—Ç–µ:
const AIAdminV2 = require('../services/ai-admin-v2');

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
pm2 restart ai-admin-worker-v2
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è DashScope: https://www.alibabacloud.com/help/en/model-studio/
- –ú–æ–¥–µ–ª–∏ Qwen: https://qwenlm.github.io/
- –õ–æ–≥–∏: `/root/.pm2/logs/ai-admin-worker-v2-*.log`