#!/usr/bin/env node

/**
 * Fix Pilot Program pricing: 14,990‚ÇΩ PER MONTH (not for 3 months)
 */

const { google } = require('googleapis');
const path = require('path');

const SPREADSHEET_ID = '1c3TSGl9It3byKuH1RCKU1ijVV3soPLLefC36Y82rlGg';
const KEY_FILE = path.join(__dirname, '../../config/google-service-account.json');

async function getSheets() {
  const auth = new google.auth.GoogleAuth({
    keyFile: KEY_FILE,
    scopes: ['https://www.googleapis.com/auth/spreadsheets'],
  });

  const authClient = await auth.getClient();
  return google.sheets({ version: 'v4', auth: authClient });
}

/**
 * Corrected Pilot Program Data - 14,990‚ÇΩ PER MONTH
 */
function getCorrectedPilotData() {
  return [
    ['üöÄ PILOT PROGRAM - 30 –ö–û–ú–ü–ê–ù–ò–ô', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['üìã –£–°–õ–û–í–ò–Ø –ü–ò–õ–û–¢–ê', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–ü–∞—Ä–∞–º–µ—Ç—Ä', '–ó–Ω–∞—á–µ–Ω–∏–µ', '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è', '', '', '', ''],
    ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π', 30, '–ü–∏–ª–æ—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞', '', '', '', ''],
    ['–¶–µ–Ω–∞ –ø–∏–ª–æ—Ç–∞ (‚ÇΩ/–º–µ—Å)', 14990, '–í –º–µ—Å—è—Ü', '', '', '', ''],
    ['–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–µ—Å—è—Ü–µ–≤)', 3, '–ü–∏–ª–æ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥', '', '', '', ''],
    ['Rev Share (%)', '20%', 'YClients –∫–æ–º–∏—Å—Å–∏—è', '', '', '', ''],
    ['–ù–∞–ª–æ–≥ (–£–°–ù IT)', '1%', '–£–°–ù –¥–ª—è IT', '', '', '', ''],
    ['–≠–∫–≤–∞–π—Ä–∏–Ω–≥ (%)', '3,3%', '–î–æ 700K –æ–±–æ—Ä–æ—Ç', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['üí∞ REVENUE (3 –º–µ—Å—è—Ü–∞)', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–°—Ç–∞—Ç—å—è', '–§–æ—Ä–º—É–ª–∞', '–ú–µ—Å—è—Ü 1', '–ú–µ—Å—è—Ü 2', '–ú–µ—Å—è—Ü 3', '–ò–¢–û–ì–û 3 –º–µ—Å', '–°—Ä–µ–¥–Ω/–º–µ—Å'],
    ['MRR (–º–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞)', '–ö–æ–º–ø–∞–Ω–∏–∏ √ó –¶–µ–Ω–∞/–º–µ—Å', '=B6*B7', '=C16', '=C16', '=C16+D16+E16', '=F16/3'],
    ['', '', '', '', '', '', ''],
    ['üí∏ VARIABLE COSTS (3 –º–µ—Å—è—Ü–∞)', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–°—Ç–∞—Ç—å—è', '% –æ—Ç –≤—ã—Ä—É—á–∫–∏', '–ú–µ—Å—è—Ü 1', '–ú–µ—Å—è—Ü 2', '–ú–µ—Å—è—Ü 3', '–ò–¢–û–ì–û 3 –º–µ—Å', '–°—Ä–µ–¥–Ω/–º–µ—Å'],
    ['Rev Share (YClients)', '20%', '=C16*0,2', '=D16*0,2', '=E16*0,2', '=C21+D21+E21', '=F21/3'],
    ['LLM Cost (Gemini 2.5 Flash-Lite)', '–ò–∑ Parameters', '=B6*Parameters!B12', '=C22', '=C22', '=C22+D22+E22', '=F22/3'],
    ['–≠–∫–≤–∞–π—Ä–∏–Ω–≥', '3,3%', '=C16*0,033', '=D16*0,033', '=E16*0,033', '=C23+D23+E23', '=F23/3'],
    ['–ò–¢–û–ì–û Variable Costs', '', '=C21+C22+C23', '=D21+D22+D23', '=E21+E22+E23', '=C24+D24+E24', '=F24/3'],
    ['', '', '', '', '', '', ''],
    ['üè¢ FIXED COSTS (3 –º–µ—Å—è—Ü–∞)', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–°—Ç–∞—Ç—å—è', '–°—Ç–∞–≤–∫–∞', '–ú–µ—Å—è—Ü 1', '–ú–µ—Å—è—Ü 2', '–ú–µ—Å—è—Ü 3', '–ò–¢–û–ì–û 3 –º–µ—Å', '–°—Ä–µ–¥–Ω/–º–µ—Å'],
    ['VPS (30 –∫–æ–º–ø–∞–Ω–∏–π = Mid tier)', '‚ÇΩ/–º–µ—Å', '=Infrastructure!C3', '=C29', '=C29', '=C29+D29+E29', '=F29/3'],
    ['–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Mid tier)', '‚ÇΩ/–º–µ—Å', '=Infrastructure!D3', '=C30', '=C30', '=C30+D30+E30', '=F30/3'],
    ['–ò–¢–û–ì–û Fixed Costs', '', '=C29+C30', '=D29+D30', '=E29+E30', '=C31+D31+E31', '=F31/3'],
    ['', '', '', '', '', '', ''],
    ['üìä PROFITABILITY (3 –º–µ—Å—è—Ü–∞)', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–ú–µ—Ç—Ä–∏–∫–∞', '', '–ú–µ—Å—è—Ü 1', '–ú–µ—Å—è—Ü 2', '–ú–µ—Å—è—Ü 3', '–ò–¢–û–ì–û 3 –º–µ—Å', '–°—Ä–µ–¥–Ω/–º–µ—Å'],
    ['Contribution Margin', '', '=C16-C24', '=D16-D24', '=E16-E24', '=C36+D36+E36', '=F36/3'],
    ['Contribution Margin %', '', '=C36/C16', '=D36/D16', '=E36/E16', '=F36/F16', '=G36'],
    ['', '', '', '', '', '', ''],
    ['EBITDA', '', '=C36-C31', '=D36-D31', '=E36-E31', '=C39+D39+E39', '=F39/3'],
    ['EBITDA %', '', '=C39/C16', '=D39/D16', '=E39/E16', '=F39/F16', '=G39'],
    ['', '', '', '', '', '', ''],
    ['–ù–∞–ª–æ–≥ (1%)', '', '=C16*0,01', '=D16*0,01', '=E16*0,01', '=C42+D42+E42', '=F42/3'],
    ['', '', '', '', '', '', ''],
    ['NET PROFIT (–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å)', '', '=C39-C42', '=D39-D42', '=E39-E42', '=C44+D44+E44', '=F44/3'],
    ['NET MARGIN %', '', '=C44/C16', '=D44/D16', '=E44/E16', '=F44/F16', '=G44'],
    ['', '', '', '', '', '', ''],
    ['–ü—Ä–∏–±—ã–ª—å –Ω–∞ —É—á—Ä–µ–¥–∏—Ç–µ–ª—è', '', '=IF(Parameters!B7>0,C44/Parameters!B7,0)', '=IF(Parameters!B7>0,D44/Parameters!B7,0)', '=IF(Parameters!B7>0,E44/Parameters!B7,0)', '=IF(Parameters!B7>0,F44/Parameters!B7,0)', '=IF(Parameters!B7>0,G44/Parameters!B7,0)'],
    ['', '', '', '', '', '', ''],
    ['üìà UNIT ECONOMICS (–Ω–∞ 1 –∫–æ–º–ø–∞–Ω–∏—é)', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–ú–µ—Ç—Ä–∏–∫–∞', '', '–ó–∞ 3 –º–µ—Å—è—Ü–∞', '–í –º–µ—Å—è—Ü', '', '', ''],
    ['Revenue –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=B7*B8', '=B7', '', '', ''],
    ['Variable costs –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=F24/B6', '=G24/B6', '', '', ''],
    ['Fixed costs –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=F31/B6', '=G31/B6', '', '', ''],
    ['Contribution Margin –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=C52-C53', '=D52-D53', '', '', ''],
    ['EBITDA –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=C55-C54', '=D55-D54', '', '', ''],
    ['NET PROFIT –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—é', '', '=F44/B6', '=G44/B6', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['üéØ KEY INSIGHTS', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–ò–Ω—Å–∞–π—Ç', '–ó–Ω–∞—á–µ–Ω–∏–µ', '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π', '–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è', '', '', ''],
    ['–¶–µ–Ω–∞ –ø–∏–ª–æ—Ç–∞ vs –æ–±—ã—á–Ω–∞—è', '=B7', '=B7/Parameters!B5', '=TEXT(C62,"0.0%") & " –æ—Ç –æ–±—ã—á–Ω–æ–π —Ü–µ–Ω—ã"', '', '', ''],
    ['–ú–∞—Ä–∂–∞ –ø–∏–ª–æ—Ç–∞ vs –æ–±—ã—á–Ω–∞—è', '=TEXT(G44,"0.0%")', '=G44/Scaling!L3', '=TEXT(C63,"0.0%") & " –æ—Ç –æ–±—ã—á–Ω–æ–π –º–∞—Ä–∂–∏"', '', '', ''],
    ['MRR –ø–∏–ª–æ—Ç–∞ (30 –∫–æ–º–ø–∞–Ω–∏–π)', '=G16', '=G16/Scaling!B6', '=TEXT(C64,"0.0%") & " –æ—Ç —Ü–µ–ª–∏ –≤ 50 —Å–∞–ª–æ–Ω–æ–≤"', '', '', ''],
    ['–ü—Ä–∏–±—ã–ª—å –ø–∏–ª–æ—Ç–∞ vs 5 —Å–∞–ª–æ–Ω–æ–≤', '=G44', '=G44/Scaling!K3', '=TEXT(C65,"0.0%") & " –æ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–∏–±—ã–ª–∏"', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['üí° –°–¢–†–ê–¢–ï–ì–ò–ß–ï–°–ö–ê–Ø –¶–ï–ù–ù–û–°–¢–¨', '', '', '', '', '', ''],
    ['', '', '', '', '', '', ''],
    ['–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å', '–û–ø–∏—Å–∞–Ω–∏–µ', '', '', '', '', ''],
    ['Validation —Å–∫–æ—Ä–æ—Å—Ç—å', '30 –∫–æ–º–ø–∞–Ω–∏–π –∑–∞ 3 –º–µ—Å—è—Ü–∞ = –±—ã—Å—Ç—Ä—ã–π PMF —Ç–µ—Å—Ç', '', '', '', '', ''],
    ['Conversion –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª', '–ü—Ä–∏ 50% –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø–æ–ª–Ω—É—é —Ü–µ–Ω—É: 15 √ó 50K = 750K MRR', '', '', '', '', ''],
    ['Learning –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å', '–°–æ–±—Ä–∞—Ç—å feedback –æ—Ç 30 –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞', '', '', '', '', ''],
    ['Testimonials –±–∞–∑–∞', '30 –∫–æ–º–ø–∞–Ω–∏–π = –º–æ—â–Ω–∞—è —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è Scale —ç—Ç–∞–ø–∞', '', '', '', '', ''],
    ['Cash flow', '~450K/–º–µ—Å—è—Ü immediate revenue –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è costs', '', '', '', '', ''],
    ['ROI –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞', '–ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ (14,990‚ÇΩ vs 50,000‚ÇΩ) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', '', '', '', '', ''],
  ];
}

async function fixPilotPrice() {
  console.log('üîß Correcting Pilot Program pricing...\n');

  try {
    const sheets = await getSheets();

    console.log('üìù Updating to 14,990‚ÇΩ PER MONTH...');

    const correctedData = getCorrectedPilotData();

    await sheets.spreadsheets.values.update({
      spreadsheetId: SPREADSHEET_ID,
      range: 'Pilot_Program!A1',
      valueInputOption: 'USER_ENTERED',
      resource: {
        values: correctedData,
      },
    });

    console.log(`‚úÖ Pilot_Program corrected (${correctedData.length} rows)\n`);

    console.log('üéâ SUCCESS! Pricing fixed!\n');
    console.log('üìä View your spreadsheet:');
    console.log(`   https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}\n`);
    console.log('‚ú® Changes:');
    console.log('   ‚úÖ –¶–µ–Ω–∞: 14,990‚ÇΩ –í –ú–ï–°–Ø–¶ (–±—ã–ª–æ: –∑–∞ 3 –º–µ—Å—è—Ü–∞)');
    console.log('   ‚úÖ MRR = 30 √ó 14,990‚ÇΩ = 449,700‚ÇΩ/–º–µ—Å—è—Ü');
    console.log('   ‚úÖ Total –∑–∞ 3 –º–µ—Å—è—Ü–∞ = 1,349,100‚ÇΩ');
    console.log('   ‚úÖ Unit economics –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n');

  } catch (error) {
    console.error('‚ùå Error fixing pricing:', error.message);
    process.exit(1);
  }
}

fixPilotPrice();
