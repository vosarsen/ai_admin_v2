# TODO: –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–î–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è**: 25 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å**: –û–∂–∏–¥–∞—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏

## 1. –û—à–∏–±–∫–∞ 403 –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ YClients

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ YClients API –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏ 403.

### –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
```
POST company/962302/clients/search - 403
"–ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–µ–π"

POST clients/962302 - 403  
"–ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª–∏–∞–ª–æ–º —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º 962302"
```

### –ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- `src/services/ai-admin-v2/modules/command-handler.js` - –º–µ—Ç–æ–¥ `createBooking()`
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –Ω–∞–π—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ

### –í–ª–∏—è–Ω–∏–µ
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ YClients
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –≤ YClients
- ‚úÖ –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π (–∑–∞–ø–∏—Å–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–ª–∏–µ–Ω—Ç—É)

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ `.env`:
   - `YCLIENTS_API_KEY`
   - `YCLIENTS_USER_TOKEN`
   - `YCLIENTS_PARTNER_ID`

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ YClients –¥–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —Ç–æ–∫–µ–Ω–∞

3. –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π endpoint –∏–ª–∏ –º–µ—Ç–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é YClients –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ API

## 2. –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ Supabase

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ YClients, –ø–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î Supabase –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π.

### –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
```
Failed to save booking to database:
```

### –ì–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- `src/services/ai-admin-v2/index.js` - –º–µ—Ç–æ–¥ `processAIResponse()`, —Å—Ç—Ä–æ–∫–∏ 670-699
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ YClients

### –ö–æ–¥ —Å –æ—à–∏–±–∫–æ–π
```javascript
const { error } = await supabase
  .from('bookings')
  .insert([bookingData]);
  
if (error) {
  logger.error('Failed to save booking to database:', error);
}
```

### –í–ª–∏—è–Ω–∏–µ
- ‚ùå –ó–∞–ø–∏—Å–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚ùå –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω–æ–π
- ‚úÖ –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ YClients
- ‚úÖ –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç—É

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
1. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏:
   ```javascript
   logger.error('Failed to save booking to database:', {
     error: error.message,
     code: error.code,
     details: error.details,
     bookingData
   });
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã `bookings` –≤ Supabase

3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π –≤ `bookingData` —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü—ã

4. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ RLS –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –≤ Supabase

## 3. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∏–∑–∫–æ–º success rate

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∏–∑–∫–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–µ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ YClients API.

### –õ–æ–≥–∏
```
üìä YclientsClient Stats: 33% success, 166.33333333333334ms avg response
‚ö†Ô∏è Low success rate: 33%
```

### –í–ª–∏—è–Ω–∏–µ
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å API –∏–ª–∏ —Å–µ—Ç—å—é
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è retry –º–µ—Ö–∞–Ω–∏–∑–º—É

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
1. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç–∏–ø–∞–º –æ—à–∏–±–æ–∫
2. –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã API YClients

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–í—ã—Å–æ–∫–∏–π**: –û—à–∏–±–∫–∞ 403 YClients - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
2. **–°—Ä–µ–¥–Ω–∏–π**: –û—à–∏–±–∫–∞ Supabase - –≤–∞–∂–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏–∏
3. **–ù–∏–∑–∫–∏–π**: Success rate - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å—Ç–æ–∏—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

- –í—Å–µ –æ—à–∏–±–∫–∏ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ—à–∏–±–æ–∫